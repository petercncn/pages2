
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta name="description" content="“ 其实本篇文章讲的是ArcGIS应用于机器学习方向上的两个模型。一个深度学习算法模型：FullyConne">
                <meta name="keywords" content="机器学习or深度学习？, “ 其实本篇文章讲的是ArcGIS应用于机器学习方向上的两个模型。一个深度学习算法模型：FullyConne">
                <meta property="og:title" content="机器学习or深度学习？">
                <title>机器学习or深度学习？</title>
                <style>.hidden{visibility:hidden;font-size:1px;}</style>
            </head>
            <body>
                <div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
机器学习or深度学习？
          </h1>

<div class="rich_media_content js_underline_content" id="js_content" style="visibility: visible;"><section style="max-width: 100%;box-sizing: border-box;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 10px;padding-left: 10px;max-width: 100%;box-sizing: border-box;line-height: 1.6;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 30px;padding-left: 30px;max-width: 100%;box-sizing: border-box;line-height: 1.6;word-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 20px;box-sizing: border-box !important;word-wrap: break-word !important;">“</span></strong><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"> 其实本篇文章讲的是ArcGIS应用于机器学习方向上的两个模型。一个深度学习算法模型：FullyConnectedNetwork，一个机器学习算法模型（模型集）：MLModel。温馨提示：</span><span style="max-width: 100%;color: rgb(255, 104, 39);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong>内容较多，请耐心食用</strong></span><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">。<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 20px;box-sizing: border-box !important;word-wrap: break-word !important;">”</span></strong></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p></section></section></section></section><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 22px;padding-left: 22px;max-width: 100%;box-sizing: border-box;line-height: 1.6;word-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p></section></section></section></section><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">还是老一套，先说思路：<span style="color: rgb(255, 104, 39);"><strong>背景介绍 </strong></span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(255, 104, 39);"><strong> 数据集探索分析  </strong></span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(255, 104, 39);"><strong> FullyConnectedNetwork </strong></span><span style="color: rgb(0, 0, 0);"><strong>-&gt;</strong></span><span style="color: rgb(255, 104, 39);"><strong> MLModel </strong></span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(255, 104, 39);"><strong> 总结</strong></span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p></section></section></section></section><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p><p><br/></p><section style="max-width: 100%;box-sizing: border-box;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 20px;padding-left: 20px;max-width: 100%;box-sizing: border-box;line-height: 0.8;word-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;word-wrap: break-word !important;">01</span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;letter-spacing: 0px;color: rgb(26, 173, 25);font-size: 20px;word-wrap: break-word !important;">—</span></p></section></section></section></section><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="font-size: 20px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">背景介绍</span></p><p><br/></p><p><span style="font-size: 16px;">有一个朋友一直问我（此朋友不是虚构的），深度学习与机器学习到底有什么区别？同样机器学习做的事情，深度学习去训练不废时间么？为什么选择深度学习？</span></p><p><span style="font-size: 16px;">emmm，第一时刻我是被问懵的，这可咋忽悠，啊不，咋科普。首先，我们都知道深度学习就是机器学习的分支，那深度学习的深是什么意思呢？我们以简单的深度学习模型为例：</span></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.1864406779661017" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLGtp4k8Pv1ZA7CqjqUHcgoAfKXra7ztwvRSMbnuctL0VQE3P2Q6asWQ/640?wx_fmt=png" data-type="png" data-w="826" src="20240525_023109_0.jpeg" style=""/></p><p><span style="font-size: 16px;">上图中的模型经过了一个三个Linear()操作，那在机器学习中一个Linear()就相当于机器学习中一个线性回归模型了，所以深度学习中的深是因为模型层数很深<img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLlffePEdgzibA3gbialcyZAhlb8dOs9m2NNm53gee2PaiaMyWXae2rz32w/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023110_1.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/>。</span></p><p><br/></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;">另外，在之前的文章<a data-itemshowtype="0" data-linktype="2" href="#" tab="innerlink" target="_blank">ArcGIS API for Python:深度学习模块概览</a>中提到了两个模型：<br/></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.518341307814992" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL62KDAwaxE3fhYp9JUUTwu4DzbI3hYrBNL1SaE8gWqZWBxtpjficKZNA/640?wx_fmt=png" data-type="png" data-w="627" src="20240525_023111_2.jpeg" style=""/></p><section style="max-width: 100%;box-sizing: border-box;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 10px;padding-left: 10px;max-width: 100%;box-sizing: border-box;line-height: 1.6;word-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">其中FullyConnectedNetwork是深度学习算法模型，而MLModel是机器学习算法模型。那不正好，拿这俩模型以及<strong>波士顿房价预测案例</strong>来对比一下深度学习与机器学习。<br/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">那就，开搞！</p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br/></p><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="padding-right: 20px;padding-left: 20px;max-width: 100%;box-sizing: border-box;line-height: 0.8;word-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;word-wrap: break-word !important;">02</span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;letter-spacing: 0px;color: rgb(26, 173, 25);font-size: 20px;word-wrap: break-word !important;">—</span><br style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"/></p></section></section></section></section><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 20px;box-sizing: border-box !important;word-wrap: break-word !important;">数据集探索分析<br/></span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">在机器学习方向上，数据集的探索分析尤为重要，以为只有了解数据的情况才能知道自己该使用什么模型、如何预处理数据来提高模型精度。本文会带大家简单探索分析一下，过一把数据分析师的瘾。</p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">首先加载数据集</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="javascript"><code><span class="code-snippet_outer"># 导包</span></code><code><span class="code-snippet_outer">%matplotlib inline</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> matplotlib.pyplot <span class="code-snippet__keyword">as</span> plt</span></code><code><span class="code-snippet_outer"><br/></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> numpy <span class="code-snippet__keyword">as</span> np</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> pandas <span class="code-snippet__keyword">as</span> pd</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> IPython.display <span class="code-snippet__keyword">import</span> Image, HTML</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> arcgis.learn <span class="code-snippet__keyword">import</span> FullyConnectedNetwork, MLModel, prepare_tabulardata</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> sklearn.datasets <span class="code-snippet__keyword">import</span> load_boston</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> sklearn.preprocessing <span class="code-snippet__keyword">import</span> StandardScaler</span></code></pre></section><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 加载数据并转换成dataframe</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">boston_dataset</span> = load_boston()</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">target</span> = boston_dataset[<span class="code-snippet__string">'target'</span>].reshape(<span class="code-snippet__number">506</span>,<span class="code-snippet__number">1</span>)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">boston_df</span> = pd.DataFrame(np.hstack((boston_dataset[<span class="code-snippet__string">'data'</span>],target)),columns=np.append(boston_dataset[<span class="code-snippet__string">'feature_names'</span>],[<span class="code-snippet__string">'PRICE'</span>]))</span></code><code><span class="code-snippet_outer">boston_df</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-croporisrc="https://mmbiz.qlogo.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLZ8K4iaL0gnnibl932eDqX4TYrRj0NCEvkyiaJNLbD3GEdVPYAAhGCh1nw/0?wx_fmt=png" data-cropx1="0" data-cropx2="897.0000000000002" data-cropy1="0" data-cropy2="358.47849462365593" data-ratio="0.399108138238573" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLx0ibnmwibpD4EvxtDKuwQBrJ7LXvo5tkUKRpP775tQEcQwXyq8hb5tLQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="897" src="20240525_023112_3.jpeg" style="width: 558px;height: 223px;"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">上图中dataframe，除了PRICE那一列为房价之外，其余的全是特征，共13个，释义如下：</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.5498489425981873" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLbwdvXv7Q07TCKIJrwQESqrTsznKAXcr9iblOvz1iaYz65auWfBdm6IYA/640?wx_fmt=png" data-type="png" data-w="662" src="20240525_023113_4.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">查看一下房价分布直方图：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="php"><code><span class="code-snippet_outer">boston_X,boston_Y = load_boston(return_X_y=<span class="code-snippet__keyword">True</span>)</span></code><code><span class="code-snippet_outer">plt.figure()</span></code><code><span class="code-snippet_outer">plt.hist(boston_Y,bins=<span class="code-snippet__number">20</span>)</span></code><code><span class="code-snippet_outer">plt.show()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.6739130434782609" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLkLSzL14W6pXvYdMb3nyKfERQZaKqFzibgm01fDh3ZTC5CaDmibr7y8MA/640?wx_fmt=png" data-type="png" data-w="368" src="20240525_023114_5.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">从直方图上可以看出房价大致符合正态分布。然后看一下各列值随ID变化的趋势：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="javascript"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> range(<span class="code-snippet__number">0</span>,boston_df.shape[<span class="code-snippet__number">1</span>]):</span></code><code><span class="code-snippet_outer">        plt.figure(figsize=(<span class="code-snippet__number">20</span>,<span class="code-snippet__number">3</span>))</span></code><code><span class="code-snippet_outer">        plt.title(boston_df.columns[i])</span></code><code><span class="code-snippet_outer">        plt.plot(boston_df[boston_df.columns[i]])</span></code><code><span class="code-snippet_outer">        plt.show()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLuVh0NTzpjNBiaTDMnJg6qIQmX6tqKlAwll3tEPicstjad5pQkk6p9fdg/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023115_6.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLsnEHPVcWI8hNqGUwaMKHU4yicERblz4a8SzyYBs1ylloPN19epIdH8Q/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023116_7.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.18166089965397925" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL5WqS8jmb0WsoGaL4mY3u98nVC81mT3LVKib1VEQzX3iaXnVIkrXo7ZCw/640?wx_fmt=png" data-type="png" data-w="1156" src="20240525_023117_8.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL0IT8VkBq9ZnJzaYcUDuibx2FIOAtTibtQJkJ902BNfzyGnGz1NGgDGVA/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023119_9.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1821335646140503" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLUA2ke3wNibuibiaef5ZuVDyyR7mxTibib6bTxoWCIbdwNJKicaIqhV7cAxRg/640?wx_fmt=png" data-type="png" data-w="1153" src="20240525_023120_10.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1821335646140503" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLIjr4WEEaWt7LTTwkPicMU40tEr9QyAOkvhykgtVoUmRuXpG3RpDZUUQ/640?wx_fmt=png" data-type="png" data-w="1153" src="20240525_023121_11.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1837270341207349" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLx1TVNzUA9mOK2saiaBYaVDNv9YrLq5KicR1RndhQageoImPVYWRqIGoQ/640?wx_fmt=png" data-type="png" data-w="1143" src="20240525_023122_12.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.18166089965397925" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLgZGlJEGzK6Bxea8IQuEIygibiaOZn3U9reXPf3QBrZbfiapKP2H4AtULA/640?wx_fmt=png" data-type="png" data-w="1156" src="20240525_023123_13.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLXXfnjwEZpFpLelLYooRAEOtY7nuGiaGAjEarsJgjZMu1hP9ibucENZGg/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023124_14.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL0Nv8icgGGDB3gTnkGjpAOyWShdRroOnGicbd7RIFzeYgsIWg6zfrYplQ/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023125_15.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.18166089965397925" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLD4XfecGTQtne5aqwJDNfBX5yiaGEwNe44rWDq0s2GGicQC0Q1R30ME8A/640?wx_fmt=png" data-type="png" data-w="1156" src="20240525_023126_16.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLdN8X8rzROdGIloTJ3DXMtX7oPOa7zIPZsia9w9v5U7iczA9JpaicicPBCQ/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023127_17.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.18166089965397925" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL0d0QuCW9hG2jTGiaW8HSEibZOC1ChJGvB5spAPpJuia1Ip0Kb7VDcYRLw/640?wx_fmt=png" data-type="png" data-w="1156" src="20240525_023128_18.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.1826086956521739" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLkFmdjL0zibBFicOZ9CjfeJ6QLRZR7bBvBib0u6zkFIfOzM6xFO5lxeVibw/640?wx_fmt=png" data-type="png" data-w="1150" src="20240525_023130_19.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在上面14张图中，最上面的是房价，从下面的图中找到变化趋势跟第一张图越接近就说明相关性越大。当然除了看趋势之外，还可以直接使用df.corr()函数查看相关性：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer">corr = boston_df.corr()</span></code><code><span class="code-snippet_outer">corr.style.background_gradient(cmap='Greens').set_precision(2)</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5404120443740095" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLj9zjiaoUibw1cUyojcbiaxMUsa4BVLH9osTDkutLQ2JDtgwF5MYkicrOAg/640?wx_fmt=png" data-type="png" data-w="631" src="20240525_023131_20.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">可以看到RM对房价影响最大（0.70），其次是ZN（0.36）。RM代表每栋住宅的房间数，ZN代表着住宅用地所占比例。结合现实生活看的话，好像是那么回事，emmmmm。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">那数据探索完了，我们知道数据中没有需要清洗的脏数据，还知道相关性较强的特征貌似有那么两个，后续可能对选模型有帮助。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><section style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="padding-right: 20px;padding-left: 20px;max-width: 100%;box-sizing: border-box;line-height: 0.8;overflow-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><br/></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;overflow-wrap: break-word !important;">03</span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;letter-spacing: 0px;color: rgb(26, 173, 25);font-size: 20px;overflow-wrap: break-word !important;">—</span><br style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"/></p></section></section></section></section><p style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 20px;box-sizing: border-box !important;overflow-wrap: break-word !important;">FullyConnectedNetwork</span></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">了解完数据之后，那不就直接提上模型训练流程：</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">首先准备数据，划分成训练集与测试集：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">train_df</span> = boston_df[:<span class="code-snippet__number">500</span>].copy()</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 测试集就6条数据，先看看效果咋样</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">test_df</span> = boston_df[<span class="code-snippet__number">500</span>:].copy()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">使用prepare_tabulardata()方法准备数据：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">X</span> = [<span class="code-snippet__string">'CRIM'</span>, <span class="code-snippet__string">'ZN'</span>, <span class="code-snippet__string">'INDUS'</span>, <span class="code-snippet__string">'CHAS'</span>, <span class="code-snippet__string">'NOX'</span>, <span class="code-snippet__string">'RM'</span>, <span class="code-snippet__string">'AGE'</span>, <span class="code-snippet__string">'DIS'</span>, <span class="code-snippet__string">'RAD'</span>, <span class="code-snippet__string">'TAX'</span>, <span class="code-snippet__string">'PTRATIO'</span>, <span class="code-snippet__string">'B'</span>, <span class="code-snippet__string">'LSTAT'</span>]</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">data</span> = prepare_tabulardata(train_df,</span></code><code><span class="code-snippet_outer">                           val_split_pct=0.2,</span></code><code><span class="code-snippet_outer">                           variable_predict='PRICE',</span></code><code><span class="code-snippet_outer">                          explanatory_variables=X</span></code><code><span class="code-snippet_outer">                          )</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">参数分别为：dataframe，验证集划分比，预测变量以及解释变量。这个解释变量就是咱们13个特征，很容易理解。<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"># 查看一个<span class="code-snippet__selector-tag">batch</span>的数据</span></code><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">data</span><span class="code-snippet__selector-class">.show_batch</span>()</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.24608150470219436" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLhsfTc577arVwx6rUZBct91Gp8FaxK6icknhgiacWurZqxljOrh99HmPQ/640?wx_fmt=png" data-type="png" data-w="638" src="20240525_023132_21.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">（其实查看不查看，意义不大，毕竟不如计算机视觉中的图片样本看的过瘾<img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLfYGZ8Lfp1IZo7oMTIbO5f16V4UpNMEhU2W5HuiblibpLDmYypNQKaluA/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023133_22.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/>）</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">然后<strong>实例化模型，模型训练以及推理</strong></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 实例化模型</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">fcn</span> = FullyConnectedNetwork(data)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 学习率查找</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">lr</span> = fcn.lr_find()</span></code><code><span class="code-snippet_outer">lr</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.44243421052631576" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLBZU4iaVxE9kozQ2E5LFPC5p0Lec0bKSeBf3ibGvmntQflKVAEQ0PnK0Q/640?wx_fmt=png" data-type="png" data-w="608" src="20240525_023134_23.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">模型训练：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">fcn</span><span class="code-snippet__selector-class">.fit</span>(300,<span class="code-snippet__selector-tag">lr</span>)</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="1.8878923766816142" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLbTgWRBebLClxMVs8XbvlD2iaq0IGQ2XnCNbNjXI5vsEqrGpViblR8ERw/640?wx_fmt=png" data-type="png" data-w="223" src="20240525_023135_24.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">（cv方向上模型训练习惯了，甚至还有点不适应这训练速度，嗖嗖嗖的）</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">训练结束之后，查看一下loss曲线：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">fcn</span><span class="code-snippet__selector-class">.plot_losses</span>()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.6735218508997429" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLtiab81GH4D4Mha2f2Sp3tMEb65rUSyvfJSk9kmP6pjSTp6qicTrGXc1g/640?wx_fmt=png" data-type="png" data-w="389" src="20240525_023136_25.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">看起来模型拟合的还不错，那就直接看得分吧：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer">r_Square_fcn_test = fcn.score() </span></code><code><span class="code-snippet_outer"><span class="code-snippet__section">print('r_Square_fcn_test: ', round(r_Square_fcn_test,5))</span></span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.09450171821305842" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLI4iaFB9ribemJm40On7MS3zh08po6JYq4ZCIq3JWIn7DPfmNcJdicynlA/640?wx_fmt=png" data-type="png" data-w="582" src="20240525_023137_26.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">0.92看上去挺不错的样子。哦对了，这个得分计量标准使用的是r2-sorce，在这里面就不详细讲原理公式了，反正就是越高越好。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">然后使用测试集测试一下模型效果：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="javascript"><code><span class="code-snippet_outer">fcn.predict(test_df,prediction_type=<span class="code-snippet__string">'dataframe'</span>)</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.2305593451568895" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLiawCicyxW1ic15J3IHIfAFsechWzmjd8I0icH9hAYIycM9k6MZKKyTADqg/640?wx_fmt=png" data-type="png" data-w="733" src="20240525_023138_27.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">emmmm，貌似看不出来啥啥来，那就整多点数据：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">big_test_df</span> = boston_df.sample(<span class="code-snippet__number">100</span>)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">big_test_prediction_df</span> = fcn.predict(big_test_df,prediction_type=<span class="code-snippet__string">'dataframe'</span>)</span></code><code><span class="code-snippet_outer">big_test_prediction_df</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.4081081081081081" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLCUDfIbByUcHFPvs4CBKp1y3l0FJ9HcHFkaicQWplW4KtjaicFmIaicYsQ/640?wx_fmt=png" data-type="png" data-w="740" src="20240525_023139_28.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">然后再查看一下r2得分：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> sklearn.metrics <span class="code-snippet__keyword">import</span> r2_score</span></code><code><span class="code-snippet_outer">r2_test = r2_score(big_test_prediction_df[<span class="code-snippet__string">'PRICE'</span>],big_test_prediction_df[<span class="code-snippet__string">'prediction_results'</span>])</span></code><code><span class="code-snippet_outer">print(<span class="code-snippet__string">'R-Square: '</span>, round(r2_test, <span class="code-snippet__number">2</span>))</span></code></pre></section><pre style="box-sizing: border-box;overflow: auto;font-size: 14px;padding-top: 1px;padding-bottom: 1px;line-height: inherit;color: rgb(0, 0, 0);word-break: break-all;overflow-wrap: break-word;background-color: rgb(255, 255, 255);border-width: 0px;border-style: initial;border-color: initial;border-radius: 0px;white-space: pre-wrap;vertical-align: baseline;text-align: left;">R-Square:  0.95</pre><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">得分看起来不错，但是好像不是那么形象。那就画图呗，清晰明了（让我回忆起以前作为一个画图仔的日子）：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">plot_df</span> = big_test_prediction_df.sort_index(</span></code><code><span class="code-snippet_outer">plt.figure(figsize=(30,6))</span></code><code><span class="code-snippet_outer">plt.plot(plot_df<span class="code-snippet__section">['PRICE']</span>,  linewidth=1, label= 'Actual') </span></code><code><span class="code-snippet_outer">plt.plot(plot_df<span class="code-snippet__section">['prediction_results']</span>, linewidth=1, label= 'Predicted')  </span></code><code><span class="code-snippet_outer">plt.ylabel('price', fontsize=14)</span></code><code><span class="code-snippet_outer">plt.legend(fontsize=14,loc='upper right')</span></code><code><span class="code-snippet_outer">plt.title('Actual Vs Predicted Price', fontsize=14)</span></code><code><span class="code-snippet_outer">plt.grid()</span></code><code><span class="code-snippet_outer">plt.show()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.21668597914252608" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL81SOZESc28TZuyUcK4KCTWCcP2mia9FPwRyNlmuUNu1yA0T8lExfLmw/640?wx_fmt=png" data-type="png" data-w="1726" src="20240525_023140_29.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">两条曲线越相近那么模型越好。那到这深度学习的算法就试了，下面使用同样的训练集、测试集等数据，尝试一下机器学习的方法。<br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><section style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="padding-right: 20px;padding-left: 20px;max-width: 100%;box-sizing: border-box;line-height: 0.8;overflow-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;overflow-wrap: break-word !important;"><br/></span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;overflow-wrap: break-word !important;">04</span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;letter-spacing: 0px;color: rgb(26, 173, 25);font-size: 20px;overflow-wrap: break-word !important;">—</span><br style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"/></p></section></section></section></section><p style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 20px;box-sizing: border-box !important;overflow-wrap: break-word !important;">MLModel</span></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在模型开始训练之前，咱们得说一下MLModel的独特之处。MLModel从某种意义上说，是sklearn中机器学习模型合计，什么意思呢？我们打开sklearn网站：<br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">https://scikit-learn.org/stable/supervised_learning.html#supervised-learning</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.8802747791952895" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLdzFnIBkEybrt9nNxQSzZ6Abykbrsol9C0NAN8vdr0V5N5cTrwGXbog/640?wx_fmt=png" data-type="png" data-w="1019" src="20240525_023141_30.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">可以看到有很多模型，那么这些模型都可以使用MLModel来读取，并进行训练预测等。就很奈斯，有木有？</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在模型实例化的时候，可以直接通过下面的示例方式去实例化：<br/></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.13550939663699307" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLzBaGM5SRguOjBELD4N4snOd7zc2cT4RlFLyN0tXEZibGYicO3ibx04icOA/640?wx_fmt=png" data-type="png" data-w="1011" src="20240525_023142_31.jpeg" style=""/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在第二个参数model_type之后可以填上模型对应的一些参数，比如上图中的n_estimators=100, random_state=43都是模型：<strong>sklearn.ensemble.GradientBoostingRegressor</strong>中的参数。如果不知道怎么设定参数的话，可以不填使用默认值就好。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在了解完MLModel怎么使用之后，还得了解一下，针对不同的数据及任务该选什么样的模型，一般情况下都是参考下图：</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.6234684260131951" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLNRCicStHALIINTckgs59sJtuUp5fYXWVvJfAoH8aic19jkmAUY1NVzFg/640?wx_fmt=png" data-type="png" data-w="2122" src="20240525_023144_32.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">为什么是一般情况下呢，因为我是所有任务相关模型都试一遍，然后选最好的用<img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL1DEqz2ch2SMibuBkeNCDmfnjwJabGW63BGicMFlQ3FgMDQEnzOecYfiag/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023145_33.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/>，因为kaggle上有过此类比赛，所以直接问的度娘别人用的都是啥模型。那我试过最好的模型是决策树：<strong>sklearn.tree.DecisionTreeRegressor</strong>。过程如下：</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">实例化模型之前，我们要重新准备数据，给数据添加上标准化处理的过程：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">preprocessors</span> = [(<span class="code-snippet__string">'CRIM'</span>, <span class="code-snippet__string">'ZN'</span>, <span class="code-snippet__string">'INDUS'</span>, <span class="code-snippet__string">'CHAS'</span>, <span class="code-snippet__string">'NOX'</span>, <span class="code-snippet__string">'RM'</span>, <span class="code-snippet__string">'AGE'</span>, <span class="code-snippet__string">'DIS'</span>, <span class="code-snippet__string">'RAD'</span>, <span class="code-snippet__string">'TAX'</span>, <span class="code-snippet__string">'PTRATIO'</span>, <span class="code-snippet__string">'B'</span>, <span class="code-snippet__string">'LSTAT'</span>,StandardScaler())</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">data</span> = prepare_tabulardata(train_df,<span class="code-snippet__string">"PRICE"</span>,explanatory_variables=X,preprocessors=preprocessors)</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">然后实例化模型、训练：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 实例化模型</span></span></code><code><span class="code-snippet_outer">model = MLModel(data,'sklearn.tree.DecisionTreeRegressor')</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 模型训练</span></span></code><code><span class="code-snippet_outer">model.fit()</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 模型得分</span></span></code><code><span class="code-snippet_outer">model.score()</span></code></pre></section><pre style="box-sizing: border-box;overflow: auto;font-size: 14px;padding-top: 1px;padding-bottom: 1px;line-height: inherit;color: rgb(0, 0, 0);word-break: break-all;overflow-wrap: break-word;background-color: rgb(255, 255, 255);border-width: 0px;border-style: initial;border-color: initial;border-radius: 0px;white-space: pre-wrap;vertical-align: baseline;text-align: left;">0.7081950576867544</pre><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">在模型训练完之后，还可以查看模型中特征与房价之间的相关性：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer">feature_imp_RF = model.feature_importances_</span></code><code><span class="code-snippet_outer">rel_feature_imp = 100 * (feature_imp_RF / max(feature_imp_RF)) </span></code><code><span class="code-snippet_outer">rel_feature_imp = pd.DataFrame({'features':list(X), 'rel_importance':rel_feature_imp })</span></code><code><span class="code-snippet_outer"><br/></span></code><code><span class="code-snippet_outer">rel_feature_imp = rel_feature_imp.sort_values('rel_importance', ascending=False)</span></code><code><span class="code-snippet_outer"><br/></span></code><code><span class="code-snippet_outer">plt.figure(figsize=[15,4])</span></code><code><span class="code-snippet_outer">plt.yticks(fontsize=10)</span></code><code><span class="code-snippet_outer">ax = sns.barplot(x=<span class="code-snippet__string">"rel_importance"</span>, y=<span class="code-snippet__string">"features"</span>, data=rel_feature_imp, palette=<span class="code-snippet__string">"BrBG"</span>)</span></code><code><span class="code-snippet_outer"><br/></span></code><code><span class="code-snippet_outer">plt.xlabel(<span class="code-snippet__string">"Relative Importance"</span>, fontsize=10)</span></code><code><span class="code-snippet_outer">plt.ylabel(<span class="code-snippet__string">"Features"</span>, fontsize=10)</span></code><code><span class="code-snippet_outer">plt.show()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.28696604600219056" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLb3nTmvZ3TUVSgVibexcvI7G8VicWOXVZuZyHeWBWHjFonMPicLkZVuF5Q/640?wx_fmt=png" data-type="png" data-w="913" src="20240525_023146_34.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">可以看到，RM相关性最高。然后咱们使用100条数据的测试集重新量化一下精度：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">ml_big_test_prediction_df</span> = model.predict(big_test_df,prediction_type=<span class="code-snippet__string">'dataframe'</span>)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__attr">ml_r2_test</span> = r2_score(ml_big_test_prediction_df[<span class="code-snippet__string">'PRICE'</span>],ml_big_test_prediction_df[<span class="code-snippet__string">'prediction_results'</span>])</span></code><code><span class="code-snippet_outer">print('R-Square: ', round(ml_r2_test, 2))</span></code></pre></section><pre style="box-sizing: border-box;overflow: auto;font-size: 14px;padding-top: 1px;padding-bottom: 1px;line-height: inherit;color: rgb(0, 0, 0);word-break: break-all;overflow-wrap: break-word;background-color: rgb(255, 255, 255);border-width: 0px;border-style: initial;border-color: initial;border-radius: 0px;white-space: pre-wrap;vertical-align: baseline;text-align: left;">R-Square:  0.78</pre><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">然后可视化，查看模型具体表现情况：<br/></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="ini"><code><span class="code-snippet_outer"><span class="code-snippet__attr">ml_plot_df</span> = ml_big_test_prediction_df.sort_index(</span></code><code><span class="code-snippet_outer">plt.figure(figsize=(30,6))</span></code><code><span class="code-snippet_outer">plt.plot(ml_plot_df<span class="code-snippet__section">['PRICE']</span>,  linewidth=1, label= 'Actual') </span></code><code><span class="code-snippet_outer">plt.plot(ml_plot_df<span class="code-snippet__section">['prediction_results']</span>, linewidth=1, label= 'Predicted')  </span></code><code><span class="code-snippet_outer">plt.ylabel('price', fontsize=14)</span></code><code><span class="code-snippet_outer">plt.legend(fontsize=14,loc='upper right')</span></code><code><span class="code-snippet_outer">plt.title('Actual Vs Predicted Price', fontsize=14)</span></code><code><span class="code-snippet_outer">plt.grid()</span></code><code><span class="code-snippet_outer">plt.show()</span></code></pre></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img data-ratio="0.21668597914252608" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLticrBPQHicKcjCu1xcpENAHO1hniaUuwW8v5nUiazQgziaOIZkPYXy0KMIA/640?wx_fmt=png" data-type="png" data-w="1726" src="20240525_023147_35.jpeg"/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">可以明显看出来，两条曲线拟合情况明显没有深度学习算法结果好，只能说是还不错。但是我相信肯定还有提升的空间，只不过我对机器学习不熟<img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL4Uh8ZMFQlIgV5KicmxdWj4xCCeqLAgH0bNAL4uoJOK7qUFlwW7hnDQg/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023148_36.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/>。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><section style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><section style="padding-right: 20px;padding-left: 20px;max-width: 100%;box-sizing: border-box;line-height: 0.8;overflow-wrap: break-word !important;"><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(26, 173, 25);font-size: 24px;overflow-wrap: break-word !important;">05</span></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;letter-spacing: 0px;color: rgb(26, 173, 25);font-size: 20px;overflow-wrap: break-word !important;">—</span><br style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"/></p></section></section></section></section><p style="color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: center;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 20px;box-sizing: border-box !important;overflow-wrap: break-word !important;">总结</span></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;">从本文中尝试结果上看，深度学习确实会提高模型精度。但是两者本身就不应该在同一个维度去比较，各有各的好处，合适的才是最好的。本文可能有不太严谨的地方，有机器学习的大佬们看到了，一定要与我联系！另外点击文末<strong>阅读全文</strong>可以查看esri官网的实际案例，思路基本上一致，更好的展示了如何使用MLModel玩转地理数据，强烈建议大家去看看<img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDL65s72bHk2DTkZ1uQzRkco91VE7q8rx6L79SdTTf85EAo7exVWxLOdg/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023149_37.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/>。</p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><section class="mp_profile_iframe_wrp"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-alias="LinoPersonal" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icicWibicWkt8pknS7FrjQQS6Lqbeu8dZL9ovyOX5PffI0R7wibhH17KtLvb64jN4AYJ9sltko0VuKVLFw/0?wx_fmt=png" data-id="Mzg2ODIxNDQ4Mg==" data-nickname="爱折腾的Lino" data-pluginname="mpprofile" data-signature="想建一座桥，连通GIS与AI。想结识一群人，为GeoAI一同奉献汗水与青春。"></mpprofile></section><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br/></p><hr style="border-style: solid;border-width: 1px 0 0;border-color: rgba(0,0,0,0.1);-webkit-transform-origin: 0 0;-webkit-transform: scale(1, 0.5);transform-origin: 0 0;transform: scale(1, 0.5);"/><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;overflow-wrap: break-word !important;text-align: center;"><span style="font-size: 15px;">本来是要给数读菌投稿的文章，毕竟在他那更有利于知识传播。但是鉴于图与代码都很多，就放弃了</span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/cFwD61lU9icibqLzpJph6B5sAS8skUcKDLfYGZ8Lfp1IZo7oMTIbO5f16V4UpNMEhU2W5HuiblibpLDmYypNQKaluA/640?wx_fmt=png" data-type="png" data-w="20" src="20240525_023150_38.jpeg" style="display:inline-block;width:20px;vertical-align:text-bottom;"/><span style="font-size: 15px;">。所以大伙们喜欢的话，就</span><strong><span style="color: rgb(255, 104, 39);">点赞、关注、分享</span></strong><span style="font-size: 15px;">吧！</span></p><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"></p></section></section></section></section></div>

</div>
                <p></p>
                <p></p>
                <div>本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 </div>
                <div  class="hidden">本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 <br><p class="hidden">code/s?__biz=Mzg2ODIxNDQ4Mg==&mid=2247484813&idx=1&sn=43ca9e34de392f644b2ef5c73a693d34&chksm=ceaef630f9d97f26dde6bf52191d22bc7137eff0eb0dd73c7511165fd23feda42d57a8576e8e#rd </p></div>
            </body>
            </html>
            