
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta name="description" content="专题\x26quot;Transformers文本生成与应用实操\x26quot;将让你全面学习使用Transformers库进行中文文本生成">
                <meta name="keywords" content="Transformers文本生成与应用实操 _ 文本生成的预处理, 专题\x26quot;Transformers文本生成与应用实操\x26quot;将让你全面学习使用Transformers库进行中文文本生成">
                <meta property="og:title" content="Transformers文本生成与应用实操 | 文本生成的预处理">
                <title>Transformers文本生成与应用实操 _ 文本生成的预处理</title>
                <style>.hidden{visibility:hidden;font-size:1px;}</style>
            </head>
            <body>
                <div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
Transformers文本生成与应用实操 | 文本生成的预处理
          </h1>

<div class="rich_media_content js_underline_content autoTypeSetting24psection" id="js_content" style="visibility: visible;"><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;line-height: 2em;"><span style='color: rgb(55, 65, 81);font-family: Söhne, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-size: 16px;letter-spacing: normal;text-align: start;white-space-collapse: preserve;'><img class="rich_pages js_insertlocalimg wxw-img" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="165" data-fileid="100003771" data-imgfileid="100011058" data-ratio="0.5712962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/iciaYydulQQ9036giblEzLarShEfquNOnLjna34ohzsejYCkrzicEvtLBCQKoQ4X2shqiawVtaTebicFibn3nq8XzEyBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="20240525_020247_0.jpeg" style='height: 330px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.578px;text-align: center;width: 578px;'/></span></section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;line-height: 2em;">专题"Transformers文本生成与应用实操"将让你全面学习使用Transformers库进行中文文本生成的过程。从理解并应用Tokenizer，了解并掌握文本生成策略，使用LLM (Language Model Prompting)进行提示引导，到灵活使用Pipeline接口实现模型的推断，我们都将进行深入探讨。同时，我们会以创建一个基于web的聊天机器人项目来实践应用这些知识。期待你的加入，一起按步就班，从理论到实战，全面提升自己的技术实力！</section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;line-height: 2em;"><br/></section><p data-sourcepos="5:1-5:188" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>在自然语言处理（NLP）任务中，文本预处理是获取高效模型性能的关键步骤。本教程将介绍如何使用Transformers库中的<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>Tokenizer</code>进行文本预处理。</p><h3 data-sourcepos="7:1-7:31" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;font-size: 1.25rem;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>自然语言预处理简介</h3><p data-sourcepos="9:1-9:274" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>文本数据的处理主要通过<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>Tokenizer</code>完成。<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>Tokenizer</code>用于将文本分解成<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokens</code>，将这些<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokens</code>转换成数字，再转换成张量，这样才能被模型使用。下面我们将通过一些示例来演示如何使用<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>Tokenizer</code>进行文本预处理。</p><h3 data-sourcepos="11:1-11:22" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;font-size: 1.25rem;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>Tokenizer的使用</h3><p data-sourcepos="13:1-13:146" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>首先，我们通过<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>AutoTokenizer.from_pretrained()</code>方法加载一个预训练的<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokenizer</code>。以下是一个如何实现此步骤的示例：</p><pre data-sourcepos="15:1-27:3" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'><span style="color: rgb(0, 119, 170);">from</span> transformers <span style="color: rgb(0, 119, 170);">import</span> AutoTokenizer<br/><br/><span style="color: rgb(0, 119, 170);">def</span> <span style="color: rgb(221, 74, 104);">auto_token</span><span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">)</span><span style="color: rgb(153, 153, 153);">:</span><br/>    tokenizer <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span> AutoTokenizer<span style="color: rgb(153, 153, 153);">.</span>from_pretrained<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(102, 153, 0);">"openbmb/MiniCPM-2B-dpo-bf16"</span><span style="color: rgb(153, 153, 153);">)</span><br/>    encoded_input <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span> tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"我是路条编程"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"你好啊"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">)</span><br/>    <span style="color: rgb(0, 119, 170);">print</span><span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(102, 153, 0);">"encoded_input:"</span> <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">+</span> <span style="color: rgb(102, 153, 0);">str</span><span style="color: rgb(153, 153, 153);">(</span>encoded_input<span style="color: rgb(153, 153, 153);">)</span><span style="color: rgb(153, 153, 153);">)</span><br/>    <span style="color: rgb(0, 119, 170);">print</span><span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(102, 153, 0);">"decode:"</span> <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">+</span> <span style="color: rgb(102, 153, 0);">str</span><span style="color: rgb(153, 153, 153);">(</span>tokenizer<span style="color: rgb(153, 153, 153);">.</span>decode<span style="color: rgb(153, 153, 153);">(</span>encoded_input<span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"input_ids"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">)</span><span style="color: rgb(153, 153, 153);">)</span><span style="color: rgb(153, 153, 153);">)</span><br/><br/><span style="color: slategray;"># 输出示例:</span><br/><span style="color: slategray;"># encoded_input: {'input_ids': [[1, 95320, 13600, 96306], [1, 79178, 95644, 95548, 18744], [1, 95320, 23523, 96240]], 'attention_mask': [[1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1]]}</span><br/><span style="color: slategray;"># decode: &lt;s&gt; 你是谁 &lt;s&gt; 我是路条编程 &lt;s&gt; 你好啊</span><br/></code></pre><h3 data-sourcepos="29:1-29:22" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;font-size: 1.25rem;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>主要返回对象</h3><p data-sourcepos="31:1-31:59" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'><code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokenizer</code>返回的字典包含以下几个重要对象：</p><ul class="list-paddingleft-1" data-sourcepos="33:1-36:0" style='padding-left: 2rem;margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'><li><p><span style="font-weight: 600;color: rgb(0, 0, 0);">input_ids</span>：每个<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>token</code>对应的索引。</p></li><li style="margin-top: 0.25rem;"><p><span style="font-weight: 600;color: rgb(0, 0, 0);">attention_mask</span>：指示模型是否应关注某个<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>token</code>。</p></li><li style="margin-top: 0.25rem;"><p><span style="font-weight: 600;color: rgb(0, 0, 0);">token_type_ids</span>：标识<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>token</code>属于哪个序列（在多序列输入的情况下）。</p></li></ul><h3 data-sourcepos="37:1-37:16" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;font-size: 1.25rem;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span></h3><p style="text-align: center;"><img class="rich_pages wxw-img js_insertlocalimg" data-imgfileid="100011060" data-ratio="0.5712962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/iciaYydulQQ9036giblEzLarShEfquNOnLjkLIEe0Njwhial7fbRmicfx9Vzpfia0QpY030GrzKIQkiaVchooLuEic0QFA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="20240525_020248_1.jpeg" style=""/></p><h3 data-sourcepos="37:1-37:16" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;font-size: 1.25rem;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'>参数详解</h3><h4 data-sourcepos="39:1-39:23" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>文本传递参数</h4><p data-sourcepos="41:1-41:68" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>你可以将单个字符串或字符串数组传递给<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokenizer</code>：</p><pre data-sourcepos="43:1-46:3" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">)</span><br/>tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"我是路条编程"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"你好啊"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">)</span><br/></code></pre><h4 data-sourcepos="48:1-48:30" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>padding_token（填充）</h4><p data-sourcepos="50:1-50:172" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>不同句子的长度可能不同，我们通过在短句子中添加<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>padding token</code>来解决这一问题。如果使用<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>padding=True</code>，需要确保已设置<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>pad_token</code>。</p><p data-sourcepos="52:1-52:92" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>注意，使用padding=True进行填充时，需要设置一个填充令牌（<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>pad_token</code>）</p><ol class="list-paddingleft-1" data-sourcepos="54:1-65:0" style='padding-left: 2rem;margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'><li><p data-sourcepos="54:4-54:346" style="margin-top: 1rem;margin-bottom: 1rem;"><span style="font-weight: 600;color: rgb(0, 0, 0);">将已有的特殊令牌指定为填充令牌</span>：如果tokenizer已经有了结束符（EOS）令牌或其他特殊令牌，你可以将其设置为填充令牌。这种方法适用于那些已经定义了结束符令牌的预训练模型。例如，对于很多基于Transformer的模型，结束符令牌可以作为填充令牌使用。</p><pre data-sourcepos="56:4-58:6" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">.</span>pad_token <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span> tokenizer<span style="color: rgb(153, 153, 153);">.</span>eos_token<br/></code></pre></li><li style="margin-top: 0.25rem;"><p data-sourcepos="60:4-60:280" style="margin-top: 1rem;margin-bottom: 1rem;"><span style="font-weight: 600;color: rgb(0, 0, 0);">向tokenizer添加一个新的填充令牌</span>：如果你的模型或数据处理策略需要一个明确的填充令牌，且现有的特殊令牌不适合用作填充令牌，你可以添加一个新的填充令牌。这通常通过调用<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>add_special_tokens</code>方法完成。</p><pre data-sourcepos="62:5-64:7" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">.</span>add_special_tokens<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">{</span><span style="color: rgb(102, 153, 0);">'pad_token'</span><span style="color: rgb(153, 153, 153);">:</span> <span style="color: rgb(102, 153, 0);">'[PAD]'</span><span style="color: rgb(153, 153, 153);">}</span><br/></code></pre></li></ol><pre data-sourcepos="66:1-69:3" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">.</span>pad_token <span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span> tokenizer<span style="color: rgb(153, 153, 153);">.</span>eos_token  <span style="color: slategray;"># 使用EOS令牌作为填充令牌</span><br/>tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"我是路条编程"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"你好啊"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">,</span> padding<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(153, 0, 85);">True</span><span style="color: rgb(153, 153, 153);">)</span><br/></code></pre><h4 data-sourcepos="71:1-71:27" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>truncation（截断）</h4><p data-sourcepos="73:1-73:110" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>对于过长的序列，我们可以通过设置<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>truncation=True</code>将其截断到模型可以接受的长度：</p><pre data-sourcepos="75:1-77:3" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"我是路条编程"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"你好啊"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">,</span> padding<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(153, 0, 85);">True</span><span style="color: rgb(153, 153, 153);">,</span> truncation<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(153, 0, 85);">True</span><span style="color: rgb(153, 153, 153);">)</span><br/></code></pre><p data-sourcepos="79:1-79:157" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>查看填充和截断概念指南，了解更多有关填充和截断参数的信息。</p><h4 data-sourcepos="81:1-81:37" style='margin-top: 1.5rem;margin-bottom: 1rem;font-weight: 600;line-height: 1.25;color: rgb(0, 0, 0);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";letter-spacing: normal;text-align: start;text-wrap: wrap;'><span style="display: inline-block;fill: currentcolor;vertical-align: middle;visibility: visible;"></span>return_tensors（返回张量）</h4><p data-sourcepos="83:1-83:139" style='margin-bottom: 1rem;caret-color: rgb(36, 41, 46);color: rgb(36, 41, 46);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;'>最后，<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tokenizer</code>可以返回直接输入到模型的张量。设置<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>return_tensors</code>参数为<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>pt</code>（PyTorch）或<code style='font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;font-size: 13.6px;padding: 0.2rem 0.4rem;background-color: rgba(27, 31, 35, 0.05);color: rgb(85, 85, 85);border-radius: 0.1875rem;'>tf</code>（TensorFlow）：</p><pre data-sourcepos="85:1-87:3" style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;font-size: 13.6px;margin-top: 0.5em;margin-bottom: 0.5em;overflow-wrap: normal;padding: 1em;overflow: auto;line-height: 1.45;background: rgb(246, 248, 250);border-radius: 0.1875rem;color: black;word-spacing: normal;word-break: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;' tabindex="0"><code style='font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;background: none;color: rgb(85, 85, 85);border-radius: 0.1875rem;word-spacing: normal;word-break: normal;overflow-wrap: normal;tab-size: 4;hyphens: none;text-shadow: white 0px 1px;border-width: 0px;border-style: initial;border-color: initial;display: inline;overflow: visible;line-height: inherit;'>tokenizer<span style="color: rgb(153, 153, 153);">(</span><span style="color: rgb(153, 153, 153);">[</span><span style="color: rgb(102, 153, 0);">"你是谁"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"我是路条编程"</span><span style="color: rgb(153, 153, 153);">,</span> <span style="color: rgb(102, 153, 0);">"你好啊"</span><span style="color: rgb(153, 153, 153);">]</span><span style="color: rgb(153, 153, 153);">,</span> padding<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(153, 0, 85);">True</span><span style="color: rgb(153, 153, 153);">,</span> truncation<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(153, 0, 85);">True</span><span style="color: rgb(153, 153, 153);">,</span> return_tensors<span style="color: rgb(154, 110, 58);background: rgba(255, 255, 255, 0.5);">=</span><span style="color: rgb(102, 153, 0);">"pt"</span><span style="color: rgb(153, 153, 153);">)</span></code></pre><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;line-height: 2em;"><br/></section><p style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;"><span style='letter-spacing: 0.578px;text-align: left;caret-color: rgba(0, 0, 0, 0);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: var(--articleFontsize);'></span></p><section style='margin-bottom: 1em;letter-spacing: 0.578px;text-wrap: wrap;color: rgba(0, 0, 0, 0.85);font-family: -apple-system, system-ui, "segoe ui", Roboto, "helvetica neue", Arial, "noto sans", sans-serif, "apple color emoji", "segoe ui emoji", "segoe ui symbol", "noto color emoji", monospace;text-align: start;background-color: rgb(255, 255, 255);text-shadow: none !important;line-height: 1.5rem !important;font-size: 1rem !important;'><span style='color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;text-align: justify;'><span style='color: rgb(0, 0, 0);font-family: "Helvetica Neue";'>今天就讲到这里，如果有问题需要咨询，大家可以直接留言或扫下方二维码来知识星球找我。也可以添加 happyzjp 微信受邀加入学习社群，我们会尽力为你解答。</span></span></section><p style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;text-align: center;"><img class="rich_pages wxw-img" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="317" data-galleryid="" data-imgfileid="100011055" data-ratio="0.549074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/iciaYydulQQ93OxeqNia1TqPwXArbUc8Ticy3FoCyibribtVwTS1udBZopKSFAicsex6CSla3PocgZH3fJ6o3fX8iaP0oA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="20240525_020249_2.jpeg" style="height: 318px;width: 578px;"/></p><section style='margin-bottom: 1em;letter-spacing: 0.578px;text-wrap: wrap;color: rgba(0, 0, 0, 0.85);font-family: -apple-system, system-ui, "segoe ui", Roboto, "helvetica neue", Arial, "noto sans", sans-serif, "apple color emoji", "segoe ui emoji", "segoe ui symbol", "noto color emoji", monospace;text-align: start;background-color: rgb(255, 255, 255);text-shadow: none !important;line-height: 1.5rem !important;font-size: 1rem !important;'><span style='color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;text-align: justify;'><span style='color: rgb(0, 0, 0);font-family: "Helvetica Neue";letter-spacing: 0.544px;'></span></span></section><section style='margin-bottom: 1em;letter-spacing: 0.578px;text-wrap: wrap;color: rgba(0, 0, 0, 0.85);font-family: -apple-system, system-ui, "segoe ui", Roboto, "helvetica neue", Arial, "noto sans", sans-serif, "apple color emoji", "segoe ui emoji", "segoe ui symbol", "noto color emoji", monospace;text-align: start;background-color: rgb(255, 255, 255);text-shadow: none !important;line-height: 1.5rem !important;font-size: 1rem !important;'><span style='color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;text-align: justify;'><span style='color: rgb(0, 0, 0);font-family: "Helvetica Neue";letter-spacing: 0.544px;'><span style="letter-spacing: 0.544px;">AI资源聚合站</span>已经正式上线，该平台不仅仅是一个AI资源聚合站，更是一个为追求知识深度和广度的人们打造的智慧聚集地。通过访问 AI 资源聚合网站 https://ai-ziyuan.techwisdom.cn/，你将进入一个全方位涵盖人工智能和语言模型领域的宝藏库<span style="letter-spacing: 0.578px;">。</span></span></span></section><p style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;"><br/></p><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;min-height: 1em;text-align: center;line-height: 2em;"><img class="rich_pages wxw-img" data-imgfileid="100011057" data-ratio="0.9921414538310412" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iciaYydulQQ90ruMCAVcr63uAiboZAp3ug8uehcxsiaLXPFaicSow2vjLXEEf6icZBniaY4J4xTLfOdmb28VebpDYxfqg/640?wx_fmt=png" data-type="png" data-w="509" src="20240525_020250_3.jpeg" style="width: 509px !important;visibility: visible !important;"/></section><section style='margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: 2em;font-family: "Helvetica Neue";min-height: 1em;color: rgb(0, 0, 0);text-align: start;'><br/></section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;min-height: 1em;text-align: center;line-height: 2em;"><img class="rich_pages wxw-img" data-imgfileid="100011056" data-ratio="0.25" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iciaYydulQQ90ruMCAVcr63uAiboZAp3ug8RHZG1aHAgF5BT17GPLiceFb683s3Aic4IibMoKNhdic1iadyt3iaice6gNicSg/640?wx_fmt=png" data-type="png" data-w="424" src="20240525_020251_4.jpeg" style="width: 424px !important;visibility: visible !important;"/></section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;min-height: 1em;text-align: center;line-height: 2em;"></section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;min-height: 1em;text-align: center;line-height: 2em;"><span style="font-size: 16px;"><strong><span style='color: rgb(0, 0, 0);font-family: "Helvetica Neue";letter-spacing: 0.544px;text-align: start;background-color: rgb(255, 255, 255);'>作者：路条编程（转载请获本公众号授权，并注明作者与出处）</span></strong></span></section><section style="margin-bottom: 0px;letter-spacing: 0.578px;text-wrap: wrap;line-height: 2em;"><br/></section><p style="margin-bottom: 0px;"><br/></p><p><br/></p><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></div>

</div>
                <p></p>
                <p></p>
                <div>本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 </div>
                <div  class="hidden">本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 <br><p class="hidden">code/s?__biz=MzIwNjYwNDQxMw==&mid=2247494711&idx=2&sn=418e1e963145959c8f973b057e7b5021&chksm=971dbd25a06a3433a249ed2515c16441d7ad1a63746621e16db343c8e8f95eaf415e7b024261#rd </p></div>
            </body>
            </html>
            