
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta name="description" content="">
                <meta name="keywords" content="【自然语言处理】应用：10分钟实现搜索引擎, ">
                <meta property="og:title" content="【自然语言处理】应用：10分钟实现搜索引擎">
                <title>【自然语言处理】应用：10分钟实现搜索引擎</title>
                <style>.hidden{visibility:hidden;font-size:1px;}</style>
            </head>
            <body>
                <div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
【自然语言处理】应用：10分钟实现搜索引擎
          </h1>

<div class="rich_media_content js_underline_content autoTypeSetting24psection" id="js_content" style="visibility: visible;"><p><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>本文利用20Newsgroup这个数据集作为Corpus(语料库)，用户可以通过搜索关键字来进行查询关联度最高的News，实现对文本的搜索引擎：</span></p><p><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>1. 导入数据集</span></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> sklearn.datasets <span class="code-snippet__keyword">import</span> fetch_20newsgroups</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">newsgroups = fetch_20newsgroups()</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">print(<span class="code-snippet__string">f'Number of documents: <span class="code-snippet__subst">{len(newsgroups.data)}</span>'</span>)</span></code><code><span class="code-snippet_outer">print(<span class="code-snippet__string">f'Sample document:\n<span class="code-snippet__subst">{newsgroups.data[<span class="code-snippet__number">0</span>]}</span>'</span>)</span></code></pre></section><p><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>2. 向量化单词</span></span></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> sklearn.feature_extraction.text <span class="code-snippet__keyword">import</span> CountVectorizer</span></code><code><span class="code-snippet_outer">count = CountVectorizer()</span></code><code><span class="code-snippet_outer">count.fit(newsgroups.data)</span></code><code><span class="code-snippet_outer">show_vocabulary(count)</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">print(<span class="code-snippet__string">f'Size of vocabulary: <span class="code-snippet__subst">{len(count.get_feature_names_out())}</span>'</span>)</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer"><span class="code-snippet__function"><span class="code-snippet__keyword">def</span> <span class="code-snippet__title">show_vocabulary</span><span class="code-snippet__params">(vectorizer)</span>:</span></span></code><code><span class="code-snippet_outer">    words = vectorizer.get_feature_names_out()</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">    print(<span class="code-snippet__string">f'Vocabulary size: <span class="code-snippet__subst">{len(words)}</span> words'</span>)</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">    <span class="code-snippet__comment"># we can print ~10 words per line</span></span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">for</span> l <span class="code-snippet__keyword">in</span> np.array_split(words, math.ceil(len(words) / <span class="code-snippet__number">10</span>)):</span></code><code><span class="code-snippet_outer">        print(<span class="code-snippet__string">''</span>.join([<span class="code-snippet__string">f'<span class="code-snippet__subst">{x:&lt;<span class="code-snippet__number">15</span>}</span>'</span> <span class="code-snippet__keyword">for</span> x <span class="code-snippet__keyword">in</span> l]))</span></code></pre></section><p><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'></span></span></span></p><p><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'><span style='outline: 0px;font-weight: 700;font-synthesis-style: auto;color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>3. 搜索引擎</span></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__comment">#将语料库进行转化</span></span></code><code><span class="code-snippet_outer">corpus_bow = count.transform(newsgroups.data)</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment">#提供用户输入，对输入内容进行转化为BoW - Bag of word</span></span></code><code><span class="code-snippet_outer">query = input(<span class="code-snippet__string">"Type your query: "</span>)</span></code><code><span class="code-snippet_outer">query_bow = count.transform([query])</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">from sklearn.metrics.pairwise import cosine_similarity</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment">#比较输入内容与语料库中的相似度</span></span></code><code><span class="code-snippet_outer">similarity_matrix = cosine_similarity(corpus_bow, query_bow)</span></code><code><span class="code-snippet_outer">print(f'Similarity Matrix Shape: {similarity_matrix.shape}')</span></code><code><span class="code-snippet_outer"> </span></code></pre></section><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'>得到Similarity_matrix一共有N行，表示语料库中的文档数。还有一列，代表相似度系数。</p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'>第K行的相似度系数，代表用户输入的文本与语料库中第K个文档的相似程度。</p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'>我们对相似度矩阵进行排序：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer">similarities = pd.Series(similarity_matrix[:, 0])</span></code><code><span class="code-snippet_outer">similarities.head(10)</span></code></pre></section><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'>那么和用户输入最相关的文档就是第一个了！</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="bash"><code><span class="code-snippet_outer"><span class="code-snippet__built_in">print</span>(<span class="code-snippet__string">'Best document:'</span>)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__built_in">print</span>(newsgroups.data[top_10.index[0]])</span></code></pre></section><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'>结论：本文利用Cosine_similarity比较文档的相似度，从语料库找出最佳匹配的文档。</p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>如果对单词的向量化，BoW概念有问题可以看下我的另一篇文章。</span></p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>CSDN</span></p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'><span style='color: rgb(77, 77, 77);font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;font-size: 16px;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);'>下面一篇文章我会具体分析Cosine_similarity的原理，敬请关注！</span></p><p style='outline: 0px;margin-bottom: 16px;font-size: 16px;color: rgb(77, 77, 77);overflow: auto hidden;font-synthesis-style: auto;font-family: -apple-system, "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif, SimHei, SimSun;letter-spacing: normal;text-align: start;text-wrap: wrap;background-color: rgb(255, 255, 255);line-height: 24px !important;'></p><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></div>

</div>
                <p></p>
                <p></p>
                <div>本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 </div>
                <div  class="hidden">本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 <br><p class="hidden">code/s?__biz=MzU4ODkxOTU1Mw==&mid=2247483685&idx=1&sn=3559a65b36eb88b94058951769bfe0a2&chksm=fdd4274bcaa3ae5dafdc483fce7950d68354f1420398a77bd6167d1413fea5297cb9257eb078#rd </p></div>
            </body>
            </html>
            