
            <!DOCTYPE html>
            <html lang="zh-CN">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta name="description" content="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF。">
                <meta name="keywords" content="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF, GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF。">
                <meta property="og:title" content="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF">
                <title>GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF</title>
                <style>.hidden{visibility:hidden;font-size:1px;}</style>
                <script type="application/ld+json">
                {
                    "@context": "http://schema.org",
                    "@type": "WebPage",
                    "name": "GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF",
                    "description": "GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF。",
                    "code": "/s?__biz=MzkzNDI1Mzc1Nw==&mid=2247490296&idx=1&sn=51aa019d935a4e08dab92e0ebf1e9845&chksm=c2415f2af536d63c74b4fd52cdd21ed95405cc5fd1e141fe42aeb4e60cd164acacb7238340eb#rd"
                }
                </script>
            </head>
            <body>
                <div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF
          </h1>

<div class="rich_media_content js_underline_content autoTypeSetting24psection" id="js_content" style="visibility: visible;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding: 0 10px;line-height: 1.6;word-spacing: 0px;letter-spacing: 0px;word-break: break-word;word-wrap: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"><h1 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 24px;"><span style="display: none;"></span><span>GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF。</span><span></span></h1><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.2480065988452021" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73Imfm59qmJF4bGQLn6qgo9UVVwX29TYeShNyB3E4rXexkhWXFZDwlAIgA/640?wx_fmt=png" data-type="png" data-w="3637" src="20240525_125824_0.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">随着 ChatGPT 的爆火，强化学习（Reinforcement Learning）和语言生成模型（Language Model）的结合开始变得越来越受人关注。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">有关 ChatGPT 的视频讲解可以参考这里。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">该项目的详细介绍可以参考<a data-linktype="2" href="#" style="text-decoration: none;color: #1e6bb8;word-wrap: break-word;font-weight: bold;border-bottom: 1px solid #1e6bb8;">这里</a>。</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.2832415420928403" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73Imib8tXAibZOAkCQ9s8OxGP9Ke7PEhPw9qVslVavH24CxINSgb721krZ8A/640?wx_fmt=jpeg" data-type="jpeg" data-w="2542" src="20240525_125825_1.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在这个项目中，我们将通过开源项目 trl 搭建一个通过强化学习算法（PPO）来更新语言模型（GPT-2）的几个示例，包括：</p><ul class="list-paddingleft-1" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">基于中文情感识别模型的正向评论生成机器人（No Human Reward）</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">基于人工打分的正向评论生成机器人（With Human Reward）</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">基于排序序列（Rank List）训练一个奖励模型（Reward Model）</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">排序序列（Rank List）标注平台</p></section></li></ul><h1 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 24px;"><span style="display: none;"></span><span>1. 基于中文情感识别模型的正向评论生成机器人（No Human Reward）</span><span></span></h1><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">考虑现在我们有一个现成的语言模型（示例中选用中文的GPT2），通过一小段 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">prompt</code>，模型能够继续生成一段文字，例如：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">prompt: 刚收到货，感觉有<br/><br/>output <span style="color: #d19a66;line-height: 26px;">1</span>: 刚收到货，感觉有 点 不 符 合 预 期 ，不 好<br/>output <span style="color: #d19a66;line-height: 26px;">2</span>: 刚收到货，感觉有 挺 无 奈 的 送 货 速 度 不 太 行<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">我们现在希望语言模型能够学会生成「正向情感」的好评，而当前的 GPT 模型是不具备「情绪识别」能力的，如上面两个生成结果都不符合正面情绪。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">为此，我们期望通过「强化学习」的方法来进化现有 GPT 模型，使其能够学会尽可能的生成「正面情感」的评论。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在强化学习中，当模型生成一个结果时，我们需要告知模型这个结果的得分（reward）是多少，即我们为模型的每一个生成结果打分，例如：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">output <span style="color: #d19a66;line-height: 26px;">1</span>: 刚收到货，感觉有 点 不 符 合 预 期 ，不 好                -&gt; <span style="color: #d19a66;line-height: 26px;">0.2</span> 分<br/>output <span style="color: #d19a66;line-height: 26px;">2</span>: 刚收到货，感觉有 挺 无 奈 的 送 货 速 度 不 太 行          -&gt; <span style="color: #d19a66;line-height: 26px;">0.1</span> 分<br/>output <span style="color: #d19a66;line-height: 26px;">3</span>: 刚收到货，感觉有 些 惊 喜 于 货 物 质 量                  -&gt; <span style="color: #d19a66;line-height: 26px;">0.9</span> 分<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">如果依靠人工为每一个输出打分，这将是一个非常漫长的过程（在另一个示例中我们将实现该功能）。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">因此，我们引入另一个「情绪识别模型」来模拟人工给出的分数。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">「情绪识别模型」我们选用 transformers 中内置的 sentiment-analysis pipeline 来实现。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">该模型基于网络评论数据集训练，能够对句子进行「正向、负向」的情绪判别，如下所示：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.6159420289855072" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73Im5YrF7HZJa9CClKRcxoHeicTKjsKLSZDT0cOicub6TjnISN0wfNOIIUZQ/640?wx_fmt=png" data-type="png" data-w="1104" src="20240525_125827_2.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">我们利用该「情感识别模型」的判别结果（0.0~1.0）作为 GPT 生成模型的 reward，以指导 GPT 模型通过强化学习（PPO）算法进行迭代更新。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 22px;"><span style="display: none;"></span><span>1.1 训练流程</span><span></span></h2><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">整个 PPO + GPT2 的训练流程如下所示：</p><ol class="list-paddingleft-1" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">随机选择一个 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">prompt</code>，如："这部电影很"</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">GPT 模型根据 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">prompt</code> 生成答案，如："这部电影很 好 看 哦 ~ "</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">将 GPT 的生成答案喂给「情绪识别」模型，并得到评分（reward），如：0.9</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">利用评分（reward）对 GPT 模型进行优化。</p></section></li></ol><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">重复该循环，直到训练结束为止。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 22px;"><span style="display: none;"></span><span>1.2 开始训练</span><span></span></h2><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">本项目基于 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">pytorch</code> + <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">transformers</code> 实现，运行前请安装相关依赖包：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">pip install -r ../requirements.txt<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">运行训练脚本：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">python ppo_sentiment_example.py<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">正常启动训练后，终端会打印如下数据：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">...<br/>epoch 0 mean-reward: 0.7271811366081238<br/>Random Sample 5 text(s) of model output:<br/>1. 刚收到货，感觉不 错 ， 会 冒 充 收 银 员 在 果 盘 盘 底 ， 就<br/>2. 说实话，真的很般 般 ， 一 般 都 是 饭 点 去 ， 没 办 法 我 现<br/>3. 说实话，真的很怪 不 得 刚 开 的 没 多 久 ， 现 在 上 海 这 个<br/>4. 这部电影很啊 ， 所 以 ， 也 算 一 个 抛 砖 引 玉 。昨 天<br/>5. 这次购物总的来说体验很[SEP] ~ 满 意 谢 谢 送 货 很 快 [SEP] 为 什 么 输 出<br/>  1%|▋                                                                                                     | 1/157 [00:55&lt;2:23:53, 55.34s/it]<br/>epoch 1 mean-reward: 0.7439988851547241<br/>Random Sample 5 text(s) of model output:<br/>1. 这次购物总的来说体验很我 不 知 道 表 盘 这 是 男 人 的? 听 说 女 人<br/>2. 这部电影很金 士 顿 鉴 定 和 暗 暗 [SEP] 正 品 。是 正 品 这<br/>3. 刚收到货，感觉是 有 些 人 吃 不 尽 的 名 字 ！~ 世 界 几 大<br/>4. 说实话，真的很对 不 起 这 个 价 钱 ， 可 能 是 因 为 做 出 来<br/>5. 说实话，真的很非 电 。31. 可 说 是 食 堂 ， 没 怎 么 规 划<br/>  1%|█▎                                                                                                    | 2/157 [01:51&lt;2:24:31, 55.95s/it]<br/>epoch 2 mean-reward: 0.8219242691993713<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">其中 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">mean-reward</code> 代表该 epoch 下模型的平均得分（来自「情绪识别模型」的反馈），<code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">Random Sample</code> 代表该模型在当前 epoch 生成的句子样例。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">logs/PPO-Sentiment-Zh.png</code> 下会保存模型训练过程中的各个指标变化（包括 reward 变化曲线）：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="1.25" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImANicVic2zVHc1SJAnvsbu2bjBrJibaM9pxA0b2CWu27MDnDKjrFnibU09Q/640?wx_fmt=png" data-type="png" data-w="2400" src="20240525_125828_3.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在模型刚开始训练的时候，GPT 会生成一些比较随机的答案，此时的平均 reward 也不会很高，会生成一些「负面」情绪的评论（如下所示）：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.18410852713178294" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImoPy96yOibvsmrSC6lAAxibYgMqSuFhQfvumUQ8XmA6CibExZpACNnWueA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1032" src="20240525_125829_4.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">随着训练，GPT 会慢慢学会偏向「正面」的情绪评论（如下所示）：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.18951612903225806" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImVKyicampVljia2JO3fyXic5nWMqgiahVzicFtRZBtyibE0EjhD0Gia1kVdyNg/640?wx_fmt=jpeg" data-type="jpeg" data-w="992" src="20240525_125830_5.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><h1 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 24px;"><span style="display: none;"></span><span>2. 基于人工打分的评论生成机器人（With Human Reward）</span><span></span></h1><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在第一个示例中，模型的 reward 来自于另一个模型。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在该示例中，我们将制作一个平台来支持人工进行打分。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">我们启动标注平台：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">python terminal_main.py<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">随后我们可以在终端看到模型的生成结果，通过人工输入 reward 以迭代模型：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.5557768924302788" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73Imr91E7gkUaJ9AP82tOqL6FrUuQsSSK7o0sxHBIuPzzEtcH4laicAicGgw/640?wx_fmt=png" data-type="png" data-w="2008" src="20240525_125831_6.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><h1 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 24px;"><span style="display: none;"></span><span>3. 基于人工排序训练 Reward Model</span><span></span></h1><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">通过排序序列训练打分模型。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">训练数据集在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">data/reward_datasets/sentiment_analysis</code>，每一行是一个排序序列（用\t符号隔开）。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">排在越前面的越偏「正向情绪」，排在越后面越「负向情绪」。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #d19a66;line-height: 26px;">1.</span>买过很多箱这个苹果了，一如既往的好，汁多味甜～	<span style="color: #d19a66;line-height: 26px;">2.</span>名不副实。	<span style="color: #d19a66;line-height: 26px;">3.</span>拿过来居然屏幕有划痕，顿时就不开心了	<span style="color: #d19a66;line-height: 26px;">4.</span>什么手机啊！一台充电很慢，信号不好！退了！又买一台竟然是次品。<br/><span style="color: #d19a66;line-height: 26px;">1.</span>一直用沙宣的洗发露！是正品！去屑止痒润发护发面面俱到！	<span style="color: #d19a66;line-height: 26px;">2.</span>觉得比外买的稀，好似加了水的	<span style="color: #d19a66;line-height: 26px;">3.</span>非常非常不满意，垃圾。	<span style="color: #d19a66;line-height: 26px;">4.</span>什么垃圾衣服，买来一星期不到口袋全拖线，最差的一次购物<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">开启训练脚本：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">sh train_reward_model.sh<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">成功开始训练后，终端会打印以下信息：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">...<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">10</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.51766</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.21</span> step/s<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">20</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.55865</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.22</span> step/s<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">30</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.60930</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.21</span> step/s<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">40</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.65024</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.21</span> step/s<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">50</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.67781</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.22</span> step/s<br/>Evaluation acc: <span style="color: #d19a66;line-height: 26px;">0.50000</span><br/>best F1 performence has been updated: <span style="color: #d19a66;line-height: 26px;">0.00000</span> --&gt; <span style="color: #d19a66;line-height: 26px;">0.50000</span><br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">60</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.69296</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.20</span> step/s<br/><span style="color: #c678dd;line-height: 26px;">global</span> step <span style="color: #d19a66;line-height: 26px;">70</span>, epoch: <span style="color: #d19a66;line-height: 26px;">1</span>, loss: <span style="color: #d19a66;line-height: 26px;">-0.70710</span>, speed: <span style="color: #d19a66;line-height: 26px;">0.20</span> step/s<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">logs/reward_model/sentiment_analysis/ERNIE Reward Model.png</code> 会存放训练曲线图：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.25" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImZth9FcWetJNxte7AI2gTPgf4UU6UOxmqvRyESBeHIE1rK0tuicibRoPQ/640?wx_fmt=png" data-type="png" data-w="2400" src="20240525_125833_7.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">完成训练后，我们运行预测脚本，可以看到训练后的模型的打分效果：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">python inference_reward_model.py<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">我们输入两句评论句子：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">texts = [<br/>    <span style="color: #98c379;line-height: 26px;">'买过很多箱这个苹果了，一如既往的好，汁多味甜～'</span>,<br/>    <span style="color: #98c379;line-height: 26px;">'一台充电很慢，信号不好！退了！又买一台竟然是次品。。服了。。'</span><br/>]<br/><br/><span style="color: #61aeee;line-height: 26px;">&gt;&gt;&gt; </span>tensor([[<span style="color: #d19a66;line-height: 26px;">10.6989</span>], [<span style="color: #d19a66;line-height: 26px;">-9.2695</span>]], grad_fn=&lt;AddmmBackward&gt;)<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">可以看到「正向评论」得到了 10.6 分，而「负向评论」得到了 -9.26 分。</p><br data-tool="mdnice编辑器"/><h1 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 24px;"><span style="display: none;"></span><span>4. 人工排序（RankList）标注平台</span><span></span></h1><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">对于第三步 Reward Model 训练，若想自定义的排序数据集，可以使用该项目中提供的标注工具：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.5745672436750998" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImPib9cMxMupnRhag0FxWav1U8DJBzl9uyubES9hC5JDujFYicSma1Nj9Q/640?wx_fmt=png" data-type="png" data-w="3004" src="20240525_125834_8.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">平台使用 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">streamlit</code> 搭建，因此使用前需要先安装三方包：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">pip install streamlit==1.17.0<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">随后，运行以下命令开启标注平台：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">sh start_ranklist_labler.sh<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">在浏览器中访问 ip + 端口（默认8904, 可在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">sh start_ranklist_labler.sh</code> 中修改端口号）即可打开标注平台。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">点击 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">随机 prompt</code> 按钮可以从 prompt池 中随机选择一个 prompt（prompt池可以在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">ranklist_labeler.py</code> 中修改 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">MODEL_CONFIG['random_prompts']</code>）。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">通过对模型生成的 4 个答案进行排序，得到从高分到低分的排序序列，点击底部的 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">存储当前排序</code> 按钮将当前排序存入本地数据集中。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">数据集将存储在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">data/human_labeled/total_dataset.tsv</code> 中（可在 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">ranklist_labeler.py</code> 中修改 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">MODEL_CONFIG['dataset_file']</code> 参数），每一行是一个 rank_list，用 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">\t</code> 分割：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style='display: block;background: url("https://mmbiz.qpic.cn/mmbiz_svg/ibkKkoaQFco6uqem6zicYB1qNSzVQzdbe2PYtnhLybO2PHrFQmz0JTicajTZZlSXx2hI5ibvcDbkHFCY6gy3sVFxgt36QVfPEiaeB/640?wx_fmt=svg") 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;'></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">今天早晨我去了 一 趟 酒 店 ， 在 check <span style="color: #c678dd;line-height: 26px;">in</span> 的 时 候 我 也 在 ， 但 是 那 位 前 任 不 让 我 进 去 ， 直 接 说 了 一 句	今天早晨我去了 中 介 的 办 公 楼 ， 看 了 我 的 婚 纱 照 ， 拍 的 时 候 已 经 是 晚 上 十 一 点 有 点 累 了 ， 我	今天早晨我去了 天 津 ， 因 为 天 气 真 是 糟 糕 ， 天 都 是 蓝 色 的 ， 但 我 在 一 个 山 坡 上 ， 因 为 时 间 短	今天早晨我去了 你 们 工 作 室 ， 一 片 混 乱 ， 有 什 么 问 题 都 没 有 ， 还 有 一 些 工 作 人 员 乱 来 乱 走 ，<br/>...<br/></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">也可以点击标注页面上方的 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">Dataset</code> 按钮，可以查看当前已存储的数据集：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img alt="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF" data-ratio="0.2520775623268698" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/WZBibiatAX4xzOUHvzyiaviaFwzrLPOs73ImagIEUkXay6UIeFnwetsT1to8zCkV4MLu6Cic699GgO3sRXoYm1GZ3Vw/640?wx_fmt=png" data-type="png" data-w="2888" src="20240525_125835_9.jpeg" style="display: block;margin: 0 auto;max-width: 100%;" title="GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF"/></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">数据标注完成后，即可参照第三步训练一个自定义的 <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;color: #1e6bb8;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;">Reward Model</code>。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">更多优质内容请关注公号：汀丶人工智能；会提供一些相关的资源和优质文章，免费获取阅读。</p><section class="mp_profile_iframe_wrp"><mp-common-profile class="js_uneditable custom_select_card mp_profile_iframe" data-alias="A962285595" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/WZBibiatAX4xxJvnokx3suPxGMNpCa1GWhwbxj4EpFicra8nwAB6EXctM78o1mnUDdd0S4NXl6cqBjWlVdMT2J9CQ/0?wx_fmt=png" data-id="MzkzNDI1Mzc1Nw==" data-is_biz_ban="0" data-nickname="汀丶人工智能" data-pluginname="mpprofile" data-signature="将不定期更新关于机器学习、强化学习、数据挖掘以及NLP等领域相关知识，以及分享自己学习到的知识技能"></mp-common-profile></section></section><p><strong>优质书籍推荐：</strong><br/></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_13633803","biz_uin":"3934253757","sku_id":"101_13633803","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-8ea2e3e3--1018824-6471657060704223232/37714581116022023/a2873ae8b589898b4cc8e6913f80a0ed.jpg","product_name":"BERT基础教程：Transformer大模型实战（一本书读懂火出圈的chatgpt！）（图灵出品）","current_price":8980,"first_category_id":"0","product_label_name_list":["京东配送"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_13633803" data-templateid="list" data-traceid="undefined"></mpcps></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding: 0 10px;line-height: 1.6;word-spacing: 0px;letter-spacing: 0px;word-break: break-word;word-wrap: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_12656251","biz_uin":"3934253757","sku_id":"101_12656251","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-ab049ee4--1018824-922708927957369404/49311341429072022/4dd05e4ad3898fd1add3fc7065a553f6.jpg","product_name":"强化学习/人工智能科学与技术丛书","current_price":8220,"first_category_id":"0","product_label_name_list":["京东配送"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_12656251" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_12453443","biz_uin":"3934253757","sku_id":"101_12453443","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-517d30cb--1018824-8450758684736298049/89140361929072022/333a35c45030c187353b24b6eaa4efc9.jpg","product_name":"强化学习实战：强化学习在阿里的技术演进和业务创新(博文视点出品)","current_price":8900,"first_category_id":"0","product_label_name_list":["秒杀","京东配送"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_12453443" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_10029410762454","biz_uin":"3934253757","sku_id":"101_10029410762454","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-e9ab4d69--1018824-3564519207420546828/25225121216082022/96716a75013a513771d22179d3c58900.jpg","product_name":"深入浅出强化学习:编程实战郭宪,宋俊潇,方勇纯","current_price":4560,"first_category_id":"0","product_label_name_list":["拼购"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_10029410762454" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_10033686967540","biz_uin":"3934253757","sku_id":"101_10033686967540","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-5f430302--1018824-6062421487932184141/48844411816082022/b8ce5b9bb7e86a1550a90cb9a2ea4f41.jpg","product_name":"深度学习花书动手学深度学习Ai人工智能机器学习教程 动手学深度学习","current_price":5102,"first_category_id":"0","product_label_name_list":["拼购"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_10033686967540" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_10033684468225","biz_uin":"3934253757","sku_id":"101_10033684468225","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-9bfb5d28--1018824-5373188438089007774/67338421816082022/c7581147f1b54c495c4156199f86c8b9.jpg","product_name":"全彩机器学习周志华人工智能入门教程西瓜书机器学习","current_price":5842,"first_category_id":"0","product_label_name_list":["拼购"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_10033684468225" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_10034879396350","biz_uin":"3934253757","sku_id":"101_10034879396350","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-872c06bd--1018824-1103595103437512088/31408531316082022/b549776137495041405b7d600d93624a.jpg","product_name":"TensorFlow深度学习——深入理解人工智能算法设计","current_price":5472,"first_category_id":"0","product_label_name_list":["拼购"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_10034879396350" data-templateid="list" data-traceid="undefined"></mpcps></p><p><mpcps class="js_editor_new_cps" data-appuin="3934253757" data-buffer='{"category_id":0,"pid":"101_10028812813656","biz_uin":"3934253757","sku_id":"101_10028812813656","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-4773ed13--1018824-8437629442082676573/92719111506012023/7839b0b588d786e2606803bcfd97f704.jpg","product_name":"神经网络与深度学习应用实战人工智能书籍深度学习优化与识别","current_price":9304,"first_category_id":"0","product_label_name_list":["拼购"],"select_tag_name_list":[],"templateId":"list","appuin":"3934253757","isNewCpsKOL":1}' data-goodssouce="1" data-pid="101_10028812813656" data-templateid="list" data-traceid="undefined"></mpcps></p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"></figure></section><p><br/></p><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></div>

</div>
                <p></p>
                <p><a href="../index.html">返回：GPT大语言模型引爆强化学习与语言生成模型的热潮、带你了解RLHF</a></p>
                <div>本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 </div>
                <div  class="hidden">本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 <br><p class="hidden">code/s?__biz=MzkzNDI1Mzc1Nw==&mid=2247490296&idx=1&sn=51aa019d935a4e08dab92e0ebf1e9845&chksm=c2415f2af536d63c74b4fd52cdd21ed95405cc5fd1e141fe42aeb4e60cd164acacb7238340eb#rd </p></div>
            </body>
            </html>
            