


            
#105 CT重建的3D深度学习技术——迭代算法详解
          




日更105天Lotus周六，周日，周一更新放射学前沿全文字数4226字，阅读需要10min。2023年发表在Tomography的文章通过广泛的文献调查，研究三维深度学习在计算机断层扫描重建中的应用。Lotus将会为各位读者带来含有Lotus查阅了大量资料的，关于这篇CT重建算法的综述的系列文献解读：#098 有趣的深度学习基础#099 如何进行3D深度学习相关文献的检索#100 60篇深度学习重建算法文章总结#104 CT重建算法基础讲解——view，projection，sinogram和FBP今天我们来介绍迭代重建算法。Part1迭代重建算法(IR)为了克服FBP的局限性，迭代重建（iterative reconstruction, IR）于2009年被引入临床使用。迭代重建（iterative reconstruction, IR）技术是重建 CT 图像的革命性方法。IR 是 CT 图像重建的范式转变，将以往的一次性（one-pass）重建过程升级为了一次成像（多次重建）过程。在IR算法设计中采用了一种迭代思路，根据模拟采集过程的数学模型反复改进图像。IR算法通过迭代过程逐渐趋向于更准确地呈现患者的解剖结构，减少伪影并提高图像质量。IR成像技术尤其适用于辐射剂量减少、投影有限、噪音或伪影普遍存在的情况。即使使用较低的 X 射线剂量，IR算法也能生成高质量的图像，从而降低与电离辐射相关的健康风险。计算技术和硬件的最新进展使医护人员更容易获得和使用IR技术，从根本上重塑了医学成像和诊断的格局。MBIR基于模型的迭代重建算法（model-based Iterative reconstruction，MBIR）在投影域的正弦图和图像域之间进行多次正向投影（forward projection）和反向投影（back projection）迭代，以优化图像质量和减少伪影。典型的MBIR的工作流程如下：典型 IR 算法的基本步骤如下：用 FBP 算法重建可测量的投影数据集（Measured Projection Data，MPD），得到生成最初的 CT 图像。可测量的投影数据和 FBP算法的工作原理详见#104 相关内容的解读。对最初的 CT 图像进行正向投影，生成模拟的投影数据，即人工原始投影数据（Artifitial Projection Data，APD）。正向投影是啥详见#104 相关内容的解读。将MPD与APD进行比较，生成新的图像（Updated image）判断新的图像（Updated image）与用户预设的图像质量标准的关系。如果不符合标准，迭代过程将反复进行，直到测量数据集和模拟数据集之间的差异非常小为止。当最终的 CT 图像符合预设的图像质量标准时，迭代过程停止。与 FBP 相比，MBIR 模型更为完整，能更有效地减少噪声和伪影。然而，MBIR 的高计算要求和较长的重建时间限制了其在临床上的广泛应用。HIR为了克服 MBIR 的计算负担，混合迭代算法（hybrid iterative reconstruction, HIR ） 应运而生 。HIR 包括投影域的正弦图的多次滤波迭代、一次反投影，以及多次图像域的去噪迭代。与 MBIR 相比，HIR因为只进行一次反投影，因此大大降低了其计算量，但相较MBIR，HIR减少噪声和伪影的能力也相对较弱。DL-IR深度学习迭代重建（Deep learning iterative reconstruction，DL-IR）是医学成像领域的一种革命性方法。DL-IR利用深度神经网络从数据中学习复杂的模式和特征，并将其整合到迭代重建过程中能够解决迭代算法出现的运算缓慢的问题。下图总结了FBP，MBIR，HIR和DL-IR的差异：Part2商用迭代算法典型的商用迭代算法包括GE HealthCare自适应统计迭代重建 (Adaptive Statistical Iterative Reconstruction，ASiR)基于模型的迭代重建 (Model-Based Iterative Reconstruction，MBIR),  即Veo算法自适应统计迭代Veo重建 (Adaptive Statistical Iterative Reconstruction Veo，ASiR-V)Siemens Healthineers图像空间迭代重建 (Iterative Reconstruction  in Image Space，IRIS)正弦图辅助迭代重建 (Sinogram Affirmed Iterative Reconstruction，SAFIRE)。高级模型迭代重建算法（advanced model-based iterative reconstruction，ADMIRE）飞利浦双模式迭代重建算法（double model based iterative reconstruction，iDose4）模型迭代重建算法（iterative model reconstruction，IMR）IMR2佳能医疗系统前向投影模型迭代（forwad projected momdel-based iterarive reconstruction， FIRST）自适应迭代剂量降低算法(Adaptive Iterative Dose Reduction,AIDR )AIDR 3D描述优点缺点算法，厂商，年份图像数据空间降噪快速，可以结合物体模型不能去伪影；不能结合光子统计和CT系统细节模型；可能改变噪声纹理IRIS, 西门子医疗, 2009; SafeCT, 蜂鸟卓越医疗, 2011投影数据空间迭代重建快速，可以结合物体模型可能丧失一部分空间分辨率和边界锐利度；未能结合CT系统细节模型；可能改变噪声纹理ASiR, GE医疗, 2009图像和投影数据空间迭代重建快速，可以分别结合光子统计模型，CT系统细节模型和物体模型可能失去一部分空间分辨率；可能改变噪声纹理AIDR, 佳能医疗, 2010; AIDR 3D, 佳能医疗, 2012;iDose4, 飞利浦医疗, 2012基于模型的迭代重建同时结合光子统计模型，CT系统细节模型和物体模型较为缓慢，可能改变噪声纹理SAFIRE, 西门子医疗, 2011;Veo, GE医疗, 2011; IMR, 飞利浦医疗, 2015; FIRST, 佳能医疗, 2016混合型迭代重建相对较快，可以分别结合光子统计模型，CT系统细节模型和物体模型可能改变噪声纹理ADMIRE, 西门子医疗, 2014；ASiR-V, GE医疗, 2015;Part3SD，MTF和NPS图像噪声，SD图像噪声（noise）可以用同质感兴趣区域内 CT值（Hounsfield 单位）的标准偏差（standard deviation，SD）来衡量。研究表明，按照物理来源，噪声有如下分类：热噪声（Thermal Noise）：也作约翰逊噪声（Jonson noise）或者奈奎斯特噪声（Nyquist noise），或者白噪声（white noise）；设备中无源器件如电阻、馈线由于电子布朗运动而引起的噪声，热噪声通常无法消除，但是与温度有关，与频率变化无关。大家如果夏天楼里一大堆人开空调，导致总线比较热的时候，有的时候看电视或者干啥会发现有电压不稳的现象，这种随温度变化的噪声就是热噪声。闪烁噪声（Flicker Noise）：也做1/f 噪声（1/f nosie）或者低频噪声（low frequency noise）；相位噪声是由于材料而产生的一种基本现象。闪烁噪声与频率相反，而且在低频时变得非常大。大家如果看过那种老式的电视的话，信号不好，比如说刮风下雨的时候，电视会出现的雪花就是闪烁噪声。相位噪声（Phase Noise）：也做jitter。相位噪声是指系统（如各种射频器件）在各种噪声的作用下引起的系统输出信号相位的随机变化。有的电视，尤其是早期旋钮的电视在换台的时候，需要一点点时间从图像有噪点到正常，这种随着换台出现的噪声就为相位噪声。散粒噪声（Shot Noise）：在大多数电子器件中，散粒噪声是主要的噪声来源。在低频和中频下，散粒噪声与频率无关（成为白噪声的一部分），高频时，散粒噪声谱变得与频率有关。我们CT图像上的绝大部分体现出来的噪声就是散粒噪声带来的。等等。在CT的X光探测过程中，最终图像所记录的噪声为上述多种形式噪声的混合体。因此，使得有着相同SD值的图片给人感官上带来的图片细腻程度可能并不相同：如下图所示：调制传递函数，MTF为了讲清楚下面的噪声功率谱的概念，Lotus先要插播一下MTF的概念，在之前Lotus为大家讲过调制传递函数（modulation transfer function，MTF）（详见#040 MTF相应部分）。可以看到MTF曲线对应的为不同频率的输入得到的输出的正弦曲线的振幅。噪声功率谱，NPS为了更好地反映不同CT系统得到图像的图像纹理，我们引入了噪声功率谱（Noise Power Spectrum，NPS） 的概念。噪声功率谱（Noise Power Spectrum，NPS）又作噪声谱密度( noise spectral density，NSD )噪声功率密度（noise power density）噪声功率谱密度（noise power spectral density）或者简称 噪声密度（noise density）如果说MTF对应的为不同频率的输入得到的输出的正弦曲线的振幅。在实际状态下，输入的正弦曲线并非完美的正弦曲线，经过成像系统，反馈到输出上，输出则也必然不可能保证是完美的正弦曲线。因此，NPS反应的是不同频率的输入得到的输出的正弦曲线的标准差。也就是说反馈的是不同频率输入信号对应的系统产生的噪声水平。在CT系统中，噪声功率谱（Noise Power Spectrum，NPS）定义为按照维纳频谱（wiener spectrum，WS）表达的噪声与空间频率的依赖关系。维纳频谱（wiener spectrum，WS）的要求是扫描一个正方的均匀物体，或者你扫一个均匀物体然后勾选出来一个正方形的ROI也行。在CT系统中，不同辐射剂量下使用FBP算法进行重建的NPS和经过正则化的NNPS（NPS曲线除以NPS曲线下面积）曲线如下图所示：可以发现：NPS的幅度：反比于辐射剂量（辐射剂量越高，NPS的幅度越小）正比于病人的辐射路径长度的指数（e^病人的辐射路径长度，此处的e为自然参数，2.7183那个）NPS的形状CT系统参数与重建核相关NPS的曲线下面积为该ROI的总噪声水平。有感兴趣想上手得到NPS曲线的朋友可以看这期教程#体模数据测量指北，一问整明白NPS，TTFPart4迭代算法的局限性MBIR，HIR和DL-IR三种IR方法都能降低图像噪声。然而，MBIR，HIR和DL-IR三种IR方法在噪声纹理方面都有共同的局限性。研究表明，IR算法，尤其是较高迭代次数的IR算法，会出现改变图像纹理的问题。如下图所示，可以看到，相比左图而言，右图明显出现了 "塑性（plastic） "和 "斑点（blotchy）"伪影：IR算法这种改变图像噪声纹理的特性，使得经过IR进行重建的图片出现 "塑性（plastic） "或 "斑点（blotchy）"伪影，妨碍了对低对比度组织界面的检测。下表总结了应用迭代算法进行低对比度诊断任务的研究结果：研究研究类型低对比体模类型观察者数量常规剂量低剂量参考标准主要发现Baker et al, AJR, 2012体模和病人低对比、低密度616.4 mGy,FBP30%, 50%,70%剂量降低; FBP,SAFIRE常规剂量图像低剂量图像CNR更高；然而，低剂量时迭代算法未能保持低对比度病灶检出Schindera et al, Radiology, 2013仅体模低对比、低密度321.6 mGy,   FBP20%, 40%,   60%, 80%剂量降低; FBP, AIDR常规剂量图像低剂量时，迭代算法未能保持低对比度病灶检出性McCollough et al, Radiology, 2015仅体模低对比、高密度316 mGy, FBP8 和 12 mGy; FBP, ASiR 和 SAFIRE常规剂量图像25%剂量降低时，无论FBP还是迭代算法，低对比度检出都下降了Saiprasad et al, Radiology, 2015仅体模低对比、高密度11未指出常规剂量7.2, 12 和 20 mGy; FBP, ASiR, IRIS 和 IDOSE 4NA不同迭代算法，不同剂量条件下，低对比度病灶检出变异较大，随剂量降低，迭代算法检测的准确性下降Solomon et al, Radiology, 2017虚拟病灶插入低对比、低密度(虚拟肝病灶)1610.3 和 13 mGy, FBP12%, 25%,   35.5%, 50%, 70%剂量降低; FBP 和 SAFIRE常规剂量图像迭代算法仅能提高约2%的检出率，或是16%的剂量下降Mileto et al, Radiology,2018仅体模低对比、低密度1614 mGy, FBP0.8-30.6mGy;   FBP, ASiR, ASiR-V, MBIR, SAFIRE 和 ADMIRE常规剂量图像迭代算法对于低对比度病灶检出提升有限，放射医生之间的差异超过了重建算法带来的变异Yoshinori et al， Acad Radiol.， 2020仅体模低对比度CHO低密度分析方法120kVp/600mAs，FBP 0.625mm和5mm120kVp/45-600mAs的 FBP，和IPV（5档）常规剂量图像迭代算法能够在保持低密度病灶的检测能力的前提下，降低50%的辐射剂量Hideki et al,  Physical and Engineering Sciences in   Medicine，. 2023仅体模低对比度5120kVp/300mAs，FBP20kVp/10-300mAs的 FBP，STD（5档）和STR（5档）常规剂量图像迭代算法能够在保持低较大（直径9mm）密度病灶的检测能力的前提下，降低50%的辐射剂量(未完待续)参考资料：R. Clough, A.I. Kirkland, in Advances in Imaging and Electron Physics, 2016《The Fundamentals of MTF, Wiener Spectra, and DQE》Robert M NishikawaSEERAM E. Dose Optimization in Digital Radiography and Computed Tomography: An Essential Guide[M/OL]. Cham: Springer International Publishing, 2023.Jerry C. Whitaker (27 April 2005). The Electronics Handbook, Second Edition. CRC Press. p. 636. ISBN 978-1-4200-3666-4.Rahman H, Khan AR, Sadiq T, Farooqi AH, Khan IU, Lim WH. A Systematic Literature Review of 3D Deep Learning Techniques in Computed Tomography Reconstruction. Tomography. 2023; 9(6):2158-2189.EULER A, SOLOMON J, MARIN D, et al. A Third-Generation Adaptive Statistical Iterative Reconstruction Technique: Phantom Study of Image Noise, Spatial Resolution, Lesion Detectability, and Dose Reduction Potential[J]. American Journal of Roentgenology, 2018, 210(6): 1301-1308.KOETZIER L R, MASTRODICASA D, SZCZYKUTOWICZ T P, et al. Deep Learning Image Reconstruction for CT: Technical Principles and Clinical Prospects[J]. Radiology, 2023, 306(3): e221257.欢迎转载和抄袭，赞赏一下，喜欢就说是你写的。如果喜欢就点点点赞，转发，在看或者在下面留言吧。创作不易，请Lotus喝盏茶～




