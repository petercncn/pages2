
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta name="description" content="关注和星标『机器学习研习院』，和小猴子一起研习，一起玩转机器学习！">
                <meta name="keywords" content="文本嵌入、文本分类和语义搜索, 关注和星标『机器学习研习院』，和小猴子一起研习，一起玩转机器学习！">
                <meta property="og:title" content="文本嵌入、文本分类和语义搜索">
                <title>文本嵌入、文本分类和语义搜索</title>
                <style>.hidden{visibility:hidden;font-size:1px;}</style>
            </head>
            <body>
                <div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
文本嵌入、文本分类和语义搜索
          </h1>

<div class="rich_media_content js_underline_content autoTypeSetting24psection" id="js_content" style="visibility: visible;"><p data-mpa-powered-by="yiban.io" style='margin-bottom: 0em;text-wrap: wrap;outline: 0px;color: rgb(34, 34, 34);font-family: system-ui, -apple-system, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;visibility: visible;'><img class="rich_pages wxw-img __bg_gif" data-imgfileid="100020471" data-ratio="0.17857142857142858" data-src="https://mmbiz.qpic.cn/mmbiz_gif/eWEPx9ZqUHsZdibxzJWHXEibvPSW0bzZIrIcDUsLxL0f6g4sMVBiaicPjdsYNcaFhibOSvNUUYsfVFo8NbportsibnFg/640?wx_fmt=gif" data-type="gif" data-w="700" src="20240525_032003_0.jpeg" style='outline: 0px;border-width: 1px;border-style: solid;border-color: rgb(238, 237, 235);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;background-color: rgb(238, 237, 235) !important;background-size: 22px !important;visibility: visible !important;width: 677px !important;background-position: center center !important;background-repeat: no-repeat !important;height: auto !important;'/></p><p class="appmsg_search_iframe_wrp" style='margin-top: 16px;text-align: justify;text-wrap: wrap;outline: 0px;color: rgb(34, 34, 34);font-family: system-ui, -apple-system, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);visibility: visible;'><img class="rich_pages wxw-img __bg_gif" data-galleryid="" data-imgfileid="100020470" data-ratio="0.1556997219647822" data-src="https://mmbiz.qpic.cn/mmbiz_gif/eWEPx9ZqUHv37au1sbcbmXpddZxLV4zJz9bxAwdQibqIFbJUCTuObpJibTeHgdtWQuv9FE4jBUQibce6eSJXoSUGg/640?wx_fmt=gif" data-type="gif" data-w="1079" src="20240525_032004_1.jpeg" style='outline: 0px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;visibility: visible !important;width: 677px !important;height: auto !important;'/><strong style="font-family: sans-serif;font-size: 18px;color: black;letter-spacing: 0px;text-align: left;"></strong><br/></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style='font-size: 16px;color: black;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;'><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">在实践中使用大型语言模型（LLM）中，RAG 的一个关键部分是使用文本嵌入从知识库中自动检索相关信息。在这里，我将更深入地讨论文本嵌入，并分享两个简单（但功能强大）的应用：文本分类和语义搜索。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">ChatGPT 吸引了全世界对人工智能及其潜力的想象。ChatGPT 的聊天界面是这一影响的关键因素，它使人工智能的力量比以往任何时候都更容易获得。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;"><strong>LLM 带来了文本嵌入方面</strong>的<strong>重大创新</strong>。在此，我将解释这些创新，以及我们如何将它们用于简单但高价值的用例。</p><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span>文本嵌入</span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">文本嵌入<strong>将文字转化为数字</strong>。然而，这些数字并不是普通的数字。它们是能捕捉底层文本含义的数字。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">这一点很重要，因为数字比文字更容易分析。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">例如，如果在参加一个交流活动，想知道房间里的人的典型身高，您可以测量每个人的身高，然后用 Excel 计算出平均值。但是，如果你想知道房间里的人的典型职位，就没有 Excel 函数可以帮你了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">这就是文本嵌入可以提供帮助的地方。如果我们有了将文本转化为数字的好方法，<strong>我们就能打开现有统计和机器学习技术的巨大工具箱</strong>，来研究文本数据。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;">文本嵌入直观解释</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">来看一个直观的例子，以便更好地理解 "将文本转化为数字"的含义。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">请看下面一组文字：<em>树</em>、<em>莲花</em>、<em>雏菊</em>、<em>太阳</em>、<em>土星</em>、<em>木星</em>、<em>卫星</em>、<em>航天飞机</em>、<em>篮球</em>和<em>棒球</em>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">虽然这看起来像是随机的词语组合，但<strong>其中一些概念比其他概念更加相似</strong>。我们可以用下面的方式来表达这些相似之处（和不同之处）。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-imgfileid="100020461" data-ratio="1.0161616161616163" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvMYsR8egicum37fhYhcTtxM0KVIxL0qBkWjwoEaLQDJ8y34Q0XkamDow/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="495" src="20240525_032005_2.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">文本嵌入的可视化表示</figcaption></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">上述可视化方式直观地组织了概念。相似的项目（如树、雏菊和莲花）往往靠得很近，而不相似的项目（如树和棒球）往往相距甚远。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">我们可以根据每个单词在上图中的位置来为其分配坐标，因此数字也符合这种情况。<strong>这些坐标（即数字）可以用来分析底层文本</strong>。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-imgfileid="100020459" data-ratio="0.9492481203007519" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvJvGnrdrgVI33icNrwziazQwsA72yLk2HxX24f1icFmBU0P8kSLbjBdUlg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="532" src="20240525_032006_3.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">坐标可用于分析文本之间的关系</figcaption></figure><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span>坐标从何而来？</span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">将文本转化为数字以提高其可计算性并不是什么新想法。早在计算机诞生之初（约 1950 年），研究人员就开始了这方面的探索。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">虽然多年来人们有无数种方法来实现这一目标，但如今，最先进的文本表示法都来自大型语言模型（LLM）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">这是因为<strong>LLM</strong>在训练过程中<strong>学习了（非常）好的文本数字表征</strong>。生成这些表示的层可以从模型中分离出来，以独立的方式使用。这一过程的结果就是文本嵌入模型。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-imgfileid="100020458" data-ratio="0.23714285714285716" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvIDMZd2U63RXB3xqa0HjxN1rCUhVJic96zutM6GMLiaR8TMibiasqykE57w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="700" src="20240525_032007_4.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">创建嵌入模型的三步秘诀。</figcaption></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">文本嵌入已经存在了几十年，是一种轻量级的、非随机的（即可预测的）技术。因此，使用它们构建人工智能系统<strong>要比构建人工智能代理简单得多，也便宜得多</strong>。</p><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span>文本分类</span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">如何使用文本嵌入来解决实际问题。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;"><strong>文本分类</strong>包括<strong>给给定文本贴标签</strong>。例如，给电子邮件贴上垃圾邮件或非垃圾邮件的标签，给信贷申请贴上高风险或低风险的标签，或者给安全警报贴上真实交易或虚假警报的标签。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">本例使用文本嵌入技术将简历分类为 "数据科学家"或 "非数据科学家"，这可能与招聘人员试图浏览大量求职者的简历有关。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">为了避免隐私问题，我使用gpt-3.5-turbo创建了一个简历合成数据集。虽然使用合成数据要求我们对结果持谨慎态度，但这个示例仍然为我们提供了如何使用文本嵌入进行分类的指导性示范。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">首先要导入依赖项。在本例中，我使用了OpenAI的文本嵌入模型（也可以使用其它模型），这需要一个 API 密钥。在这里， API 密钥存储在一个名为<em>sk.py</em> 的单独文件中。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #569CD6;line-height: 26px;">import</span> openai<br/><span style="color: #569CD6;line-height: 26px;">from</span> sk <span style="color: #569CD6;line-height: 26px;">import</span> my_sk<br/><br/><span style="color: #569CD6;line-height: 26px;">import</span> pandas <span style="color: #569CD6;line-height: 26px;">as</span> pd<br/><span style="color: #569CD6;line-height: 26px;">import</span> numpy <span style="color: #569CD6;line-height: 26px;">as</span> np<br/><span style="color: #569CD6;line-height: 26px;">import</span> matplotlib.pyplot <span style="color: #569CD6;line-height: 26px;">as</span> plt<br/><br/><span style="color: #569CD6;line-height: 26px;">from</span> sklearn.ensemble <span style="color: #569CD6;line-height: 26px;">import</span> RandomForestClassifier<br/><span style="color: #569CD6;line-height: 26px;">from</span> sklearn.metrics <span style="color: #569CD6;line-height: 26px;">import</span> roc_auc_score<br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">接下来，以 Pandas Dataframe的形式读取合成训练数据集。数据来自一个 .csv 文件，其中有两列包含简历文本和相关角色。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;">df_resume = pd.read_csv(<span style="color: #D69D85;line-height: 26px;">'resumes/resumes_train.csv'</span>)<br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;"><strong>生成嵌入式数据</strong></span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">要将简历转化为嵌入式，可以对 OpenAI API 进行简单的 API 调用。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="line-height: 26px;"><span style="color: #569CD6;line-height: 26px;">def</span> <span style="line-height: 26px;">generate_embeddings</span><span style="line-height: 26px;">(text, my_sk)</span>:</span><br/>    <span style="color: #57A64A;font-style: italic;line-height: 26px;"># set credentials</span><br/>    client = openai.OpenAI(api_key = my_sk)<br/>    <br/>    <span style="color: #57A64A;font-style: italic;line-height: 26px;"># make api call</span><br/>    response = client.embeddings.create(<br/>        input=text,<br/>        model=<span style="color: #D69D85;line-height: 26px;">"text-embedding-3-small"</span><br/>    )<br/>    <br/>    <span style="color: #57A64A;font-style: italic;line-height: 26px;"># return text embedding</span><br/>    <span style="color: #569CD6;line-height: 26px;">return</span> response.data<br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">对数据帧中的每份简历应用该函数，并将结果存储在列表中。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># generate embeddings</span><br/>text_embeddings = generate_embeddings(df_resume[<span style="color: #D69D85;line-height: 26px;">'resume'</span>], my_sk)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># extract embeddings</span><br/>text_embedding_list = <br/>  [text_embeddings[i].embedding <span style="color: #569CD6;line-height: 26px;">for</span> i <span style="color: #569CD6;line-height: 26px;">in</span> range(len(text_embeddings))]<br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;"><strong>在数据帧中存储嵌入</strong></span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">将创建一个新的数据帧来存储文本嵌入和用于模型训练的目标变量。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># define df column names</span><br/>column_names = <br/>  [<span style="color: #D69D85;line-height: 26px;">"embedding_"</span> + str(i) <span style="color: #569CD6;line-height: 26px;">for</span> i <span style="color: #569CD6;line-height: 26px;">in</span> range(len(text_embedding_list[<span style="color: #B8D7A3;line-height: 26px;">0</span>]))]<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># store text embeddings in dataframe</span><br/>df_train = pd.DataFrame(text_embedding_list, columns=column_names)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># create target variable</span><br/>df_train[<span style="color: #D69D85;line-height: 26px;">'is_data_scientist'</span>] = df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>]==<span style="color: #D69D85;line-height: 26px;">"Data Scientist"</span><br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;"><strong>模型训练</strong></span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">准备好训练数据后，用一行代码来训练分类模型（随机森林分类器）。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># split variables by predictors and target</span><br/>X = df_train.iloc[:,:-1]<br/>y = df_train.iloc[:,-1]<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># train rf model</span><br/>clf = RandomForestClassifier(max_depth=2, random_state=0).fit(X, y)<br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;"><strong>模型评估</strong></span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">为了快速了解模型的性能，我们可以在训练数据上对其进行评估（计算平均准确率和 ROC 下面积（即AUC））。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># model accuracy for training data</span><br/>print(clf.score(X,y))<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># AUC value for training data</span><br/>print(roc_auc_score(y, clf.predict_proba(X)[:,<span style="color: #B8D7A3;line-height: 26px;">1</span>]))<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># output</span><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># 1</span><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># 1</span><br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">准确率和 AUC 值均为 1 表示在训练数据集上表现完美，这一点很可疑。因此，让我们在模型从未见过的测试数据集上对其进行评估。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># import testing data</span><br/>df_resume = pd.read_csv(<span style="color: #D69D85;line-height: 26px;">'resumes/resumes_test.csv'</span>)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># generate embeddings</span><br/>text_embedding_list = generate_embeddings(df_resume[<span style="color: #D69D85;line-height: 26px;">'resume'</span>], my_sk)<br/>text_embedding_list = <br/>  [text_embedding_list[i].embedding <span style="color: #569CD6;line-height: 26px;">for</span> i <span style="color: #569CD6;line-height: 26px;">in</span> range(len(text_embedding_list))]<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># store text embeddings in dataframe</span><br/>df_test = pd.DataFrame(text_embedding_list, columns=column_names)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># create target variable</span><br/>df_test[<span style="color: #D69D85;line-height: 26px;">'is_data_scientist'</span>] = df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>]==<span style="color: #D69D85;line-height: 26px;">"Data Scientist"</span><br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># define predictors and target</span><br/>X_test = df_test.iloc[:,:<span style="color: #B8D7A3;line-height: 26px;">-1</span>]<br/>y_test = df_test.iloc[:,<span style="color: #B8D7A3;line-height: 26px;">-1</span>]<br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># model accuracy for testing data</span><br/>print(clf.score(X_test,y_test))<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># AUC value for testing data</span><br/>print(roc_auc_score(y_test, clf.predict_proba(X_test)[:,<span style="color: #B8D7A3;line-height: 26px;">1</span>]))<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># output</span><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># 0.98</span><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># 0.9983333333333333</span><br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;">解决过度拟合问题</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">虽然该模型在应用于测试数据时表现良好，但仍有可能出现过拟合，原因有二。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;"><strong>首先</strong>，我们有 1537 个预测因子，而需要预测的简历只有 100 份，因此模型要 "记住 "训练数据中的每个示例并不难。<strong>其二</strong>，训练数据和测试数据是以类似的方式从gpt-3.5-turbo生成的。因此，它们有许多共同特征，这使得分类任务比应用于真实数据更容易。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">我们可以采用很多技巧来<strong>克服过拟合问题</strong>，例如，使用预测器重要性排序来减少预测器数量，增加叶节点中样本的最小数量，或使用逻辑回归等更简单的分类技术。不过，如果我们的目标是在实际环境中使用该模型，那么最好的选择就是收集<strong>更多数据</strong>并使用<strong>现实世界中的简历</strong>。</p><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span>语义搜索</span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">接下来，让我们看看语义搜索。与基于关键字的搜索不同，语义搜索是<strong>根据用户查询的含义</strong>而不是所使用的特定单词或短语来<strong>生成结果</strong>的。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">例如，基于关键字的搜索可能不会为 "<em>我需要有人来构建我的数据基础设施</em>"这一查询提供很好的结果，因为它没有具体提及构建数据基础设施的角色（即数据工程师）。然而，语义搜索却不会担心这个问题，因为它可以将该查询匹配到具有 "<em>精通数据建模、ETL 流程和数据仓库</em>"等经验的求职者<em>。</em></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">在这里，我们将使用文本嵌入技术在与上一个用例相同的数据集上进行这种类型的搜索。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">首先导入依赖关系和合成数据集。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #569CD6;line-height: 26px;">import</span> numpy <span style="color: #569CD6;line-height: 26px;">as</span> np<br/><span style="color: #569CD6;line-height: 26px;">import</span> pandas <span style="color: #569CD6;line-height: 26px;">as</span> pd<br/><br/><span style="color: #569CD6;line-height: 26px;">from</span> sentence_transformers <span style="color: #569CD6;line-height: 26px;">import</span> SentenceTransformer<br/><br/><span style="color: #569CD6;line-height: 26px;">from</span> sklearn.decomposition <span style="color: #569CD6;line-height: 26px;">import</span> PCA<br/><span style="color: #569CD6;line-height: 26px;">from</span> sklearn.metrics <span style="color: #569CD6;line-height: 26px;">import</span> DistanceMetric<br/><br/><span style="color: #569CD6;line-height: 26px;">import</span> matplotlib.pyplot <span style="color: #569CD6;line-height: 26px;">as</span> plt<br/><span style="color: #569CD6;line-height: 26px;">import</span> matplotlib <span style="color: #569CD6;line-height: 26px;">as</span> mpl<br/>df_resume = pd.read_csv(<span style="color: #D69D85;line-height: 26px;">'resumes/resumes_train.csv'</span>)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># relabel random role as "other"</span><br/>df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>][df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].iloc[<span style="color: #B8D7A3;line-height: 26px;">-1</span>] == df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>]] = <span style="color: #D69D85;line-height: 26px;">"Other"</span> <br/></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span><span style="font-size: 18px;font-family: sans-serif;display: inline-block;border-left: 7px solid rgb(0, 191, 255);padding-left: 10px;"><strong>生成嵌入</strong></span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">接下来，我们将生成文本嵌入。我们将不使用OpenAI API，而是使用Sentence TransformersPython 库中的一个开源模型。该模型专门针对语义搜索进行了微调。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># import pre-trained model (full list: https://www.sbert.net/docs/pretrained_models.html)</span><br/>model = SentenceTransformer(<span style="color: #D69D85;line-height: 26px;">"all-MiniLM-L6-v2"</span>)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># encode text</span><br/>embedding_arr = model.encode(df_resume[<span style="color: #D69D85;line-height: 26px;">'resume'</span>])<br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">要查看数据集中的不同简历及其在概念空间中的相对位置，我们可以使用PCA]来降低嵌入向量的维度，并将数据可视化为二维图。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># apply PCA to embeddings</span><br/>pca = PCA(n_components=<span style="color: #B8D7A3;line-height: 26px;">2</span>).fit(embedding_arr)<br/>print(pca.explained_variance_ratio_)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># plot data along PCA components</span><br/>plt.figure(figsize=(<span style="color: #B8D7A3;line-height: 26px;">8</span>, <span style="color: #B8D7A3;line-height: 26px;">6</span>))<br/>plt.rcParams.update({<span style="color: #D69D85;line-height: 26px;">'font.size'</span>: <span style="color: #B8D7A3;line-height: 26px;">16</span>})<br/>plt.grid()<br/><br/>c=<span style="color: #B8D7A3;line-height: 26px;">0</span><br/>cmap = mpl.colormaps[<span style="color: #D69D85;line-height: 26px;">'jet'</span>]<br/><span style="color: #569CD6;line-height: 26px;">for</span> role <span style="color: #569CD6;line-height: 26px;">in</span> df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].unique():<br/>    idx = np.where(df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>]==role)<br/>    plt.scatter(pca.transform(embedding_arr)[idx,<span style="color: #B8D7A3;line-height: 26px;">0</span>], pca.transform(embedding_arr)[idx,<span style="color: #B8D7A3;line-height: 26px;">1</span>], c=[cmap(c)]*len(idx[<span style="color: #B8D7A3;line-height: 26px;">0</span>]), label=role)<br/>    c = c + <span style="color: #B8D7A3;line-height: 26px;">1</span>/len(df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].unique())<br/>    <br/>plt.legend(bbox_to_anchor=(<span style="color: #B8D7A3;line-height: 26px;">1.05</span>, <span style="color: #B8D7A3;line-height: 26px;">0.9</span>))<br/>plt.xticks(rotation = <span style="color: #B8D7A3;line-height: 26px;">45</span>)<br/>plt.xlabel(<span style="color: #D69D85;line-height: 26px;">"PC 1"</span>)<br/>plt.ylabel(<span style="color: #D69D85;line-height: 26px;">"PC 2"</span>)<br/>plt.show()<br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">从这个视图中，我们可以看到特定职位的简历往往聚集在一起。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-imgfileid="100020462" data-ratio="0.48714285714285716" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvGx8xt8gLRiblC33d3K1eAQ3k6PnwzwmX4S6xAdlbxghqdDAJBfjG3lA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="700" src="20240525_032009_5.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">按角色着色的简历嵌入二维图</figcaption></figure><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span><strong>语义搜索</strong></span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">现在，要对这些简历进行语义搜索，我们可以接受用户查询，将其转化为文本嵌入，然后返回嵌入空间中最近的简历。下面是代码的样子。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># define query</span><br/>query = <span style="color: #D69D85;line-height: 26px;">"I need someone to build out my data infrastructure"</span><br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># encode query</span><br/>query_embedding = model.encode(query)<br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># define distance metric (other options: manhattan, chebyshev)</span><br/>dist = DistanceMetric.get_metric(<span style="color: #D69D85;line-height: 26px;">'euclidean'</span>)<br/><br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># compute pair-wise distances between query embedding and resume embeddings</span><br/>dist_arr = <br/>  dist.pairwise(embedding_arr, query_embedding.reshape(<span style="color: #B8D7A3;line-height: 26px;">1</span>, <span style="color: #B8D7A3;line-height: 26px;">-1</span>)).flatten()<br/><span style="color: #57A64A;font-style: italic;line-height: 26px;"># sort results</span><br/>idist_arr_sorted = np.argsort(dist_arr)<br/></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">打印前 10 名结果的角色，我们发现几乎都是数据工程师，这是一个好兆头。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># print roles of top 10 closest resumes to query in embedding space</span><br/><span style="color: #4EC9B0;line-height: 26px;">print</span>(df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].iloc[idist_arr_sorted[:10]])<br/></code></pre><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-imgfileid="100020460" data-ratio="0.9239766081871345" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvs6GmAEVCMiaicSFSSvhysyB8F0Yuf3MWHGbMqfr9Mb0iboRcibErSXgKEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="342" src="20240525_032010_6.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">虽然这是一份虚构的简历，但应聘者很可能拥有满足用户需求的所有必要技能和经验。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">另一种查看搜索结果的方法是通过之前的二维图。下面是一些查询的结果（见图表标题）。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;background: #1E1E1E;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;-webkit-overflow-scrolling: touch;font-size: 10px;"><span style="color: #57A64A;font-style: italic;line-height: 26px;"># plot query along with resumes using PCA components</span><br/>query_pca = pca.transform(query_embedding.reshape(<span style="color: #B8D7A3;line-height: 26px;">1</span>, <span style="color: #B8D7A3;line-height: 26px;">-1</span>))[<span style="color: #B8D7A3;line-height: 26px;">0</span>]<br/><br/>plt.figure(figsize=(<span style="color: #B8D7A3;line-height: 26px;">8</span>, <span style="color: #B8D7A3;line-height: 26px;">6</span>))<br/>plt.rcParams.update({<span style="color: #D69D85;line-height: 26px;">'font.size'</span>: <span style="color: #B8D7A3;line-height: 26px;">16</span>})<br/>plt.grid()<br/><br/>c=<span style="color: #B8D7A3;line-height: 26px;">0</span><br/>cmap = mpl.colormaps[<span style="color: #D69D85;line-height: 26px;">'jet'</span>]<br/><span style="color: #569CD6;line-height: 26px;">for</span> role <span style="color: #569CD6;line-height: 26px;">in</span> df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].unique():<br/>    idx = np.where(df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>]==role)<br/>    plt.scatter(pca.transform(embedding_arr)[idx,<span style="color: #B8D7A3;line-height: 26px;">0</span>], pca.transform(embedding_arr)[idx,<span style="color: #B8D7A3;line-height: 26px;">1</span>], c=[cmap(c)]*len(idx[<span style="color: #B8D7A3;line-height: 26px;">0</span>]), label=role)<br/>    c = c + <span style="color: #B8D7A3;line-height: 26px;">1</span>/len(df_resume[<span style="color: #D69D85;line-height: 26px;">'role'</span>].unique())<br/><br/>plt.scatter(query_pca[<span style="color: #B8D7A3;line-height: 26px;">0</span>], query_pca[<span style="color: #B8D7A3;line-height: 26px;">1</span>], c=<span style="color: #D69D85;line-height: 26px;">'k'</span>, marker=<span style="color: #D69D85;line-height: 26px;">'*'</span>, s=<span style="color: #B8D7A3;line-height: 26px;">750</span>, label=<span style="color: #D69D85;line-height: 26px;">'query'</span>)<br/>    <br/>plt.legend(bbox_to_anchor=(<span style="color: #B8D7A3;line-height: 26px;">1.05</span>, <span style="color: #B8D7A3;line-height: 26px;">0.9</span>))<br/>plt.xticks(rotation = <span style="color: #B8D7A3;line-height: 26px;">45</span>)<br/>plt.xlabel(<span style="color: #D69D85;line-height: 26px;">"PC 1"</span>)<br/>plt.ylabel(<span style="color: #D69D85;line-height: 26px;">"PC 2"</span>)<br/>plt.title(<span style="color: #D69D85;line-height: 26px;">'"'</span> + query + <span style="color: #D69D85;line-height: 26px;">'"'</span>)<br/>plt.show()<br/></code></pre><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-imgfileid="100020467" data-ratio="0.38285714285714284" data-src="https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwv3uZ7CBoibpoLNUX20xsG157niaanOftCZniaIBujABuy2r0DNk7aVicbXQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="700" src="20240525_032011_7.jpeg" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"/><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">3 种不同查询的二维 PCA 图。</figcaption></figure><h2 data-tool="mdnice编辑器" style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/eWEPx9ZqUHvnNTtCdE8J7oLlDibcCiaFwvdzcT6bnV3L60AyDzsduNKpal72ichWK8icV0P6seibHaYrqZZ2HbN58bw/640?wx_fmt=png&amp;from=appmsg");background-size: 33px;background-repeat: no-repeat;margin-top: 38px;margin-bottom: 5px;min-height: 38px;line-height: 28px;border-bottom: 2px solid rgb(245, 245, 245);border-top-color: rgb(245, 245, 245);border-right-color: rgb(245, 245, 245);border-left-color: rgb(245, 245, 245);padding-left: 1.5em;padding-right: 1.2em;font-size: 22px;margin-left: 0.5em;text-align: center;width: 85%;display: flex;flex-direction: column;justify-content: center;'><span style="display: none;"></span><span>改进搜索</span><span></span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">虽然这个简单的搜索示例能很好地将特定候选人与给定查询进行匹配，但它并不完美。其中一个不足之处是当用户查询包含特定技能时。例如，在查询 "<em>具有 Apache Airflow 经验的数据工程师</em>"时，前 5 个结果中只有 1 个具有 Airflow 经验。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">这突出表明，<strong>语义搜索并非在所有情况下都比基于关键字的搜索更好</strong>。两者各有优缺点。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">因此，一个强大的搜索系统将采用所谓的<strong>混合搜索</strong>，将<strong>两种技术的优点结合起来</strong>。虽然设计这种系统的方法有很多，但一种简单的方法是应用基于关键字的搜索来筛选结果，然后再进行语义搜索。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">另外两种改进搜索的策略是使用<strong>重新排名器（Reranker</strong>）和<strong>微调文本嵌入</strong>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;"><strong>Reranker</strong>是一种<strong>直接比较两段文本的</strong>模型。换句话说，Reranker 不是通过嵌入空间中的距离度量来计算文本之间的相似度，而是直接计算相似度得分。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;">Reranker 常用于完善搜索结果。例如，可以使用语义搜索返回前 25 个结果，然后使用重排器精选出前 5 个结果。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;font-size: 15.5px;margin-top: 15px;line-height: 28px;"><strong>文本嵌入的微调</strong>包括<strong>针对特定领域调整嵌入模型</strong>。这是一种强大的方法，因为大多数嵌入模型都是基于广泛的文本和知识集合。因此，它们可能无法为特定行业（如数据科学和人工智能）优化组织概念。</p></section><h5 style="margin-top: 0.75em;margin-bottom: 0em;padding: 10px;font-size: 14px;text-wrap: wrap;outline: 0px;color: rgb(34, 34, 34);font-family: ExtraLight-0;background-color: rgb(248, 248, 248);border-radius: 3px;text-align: left;visibility: visible;line-height: 1.75em;word-break: break-all !important;letter-spacing: 1px !important;word-spacing: 1px !important;"><span style='outline: 0px;font-size: 13px;letter-spacing: 0px;color: black;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;'>🏴‍☠️宝藏级🏴‍☠️原创公众号『<strong style="outline: 0px;">机器学习研习院</strong>』，公众号专注分享</span><a data-linktype="2" href="#" imgdata="null" imgurl="" linktype="text" style="outline: 0px;cursor: pointer;" tab="innerlink" target="_blank" textvalue="机器学习" wah-hotarea="click"><span style='outline: 0px;color: rgb(0, 82, 255);cursor: pointer;-webkit-user-drag: none;letter-spacing: 0px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;font-size: 13px;'><strong style="outline: 0px;">机器学习</strong></span></a>｜<a data-linktype="2" href="#" imgdata="null" imgurl="" linktype="text" style="outline: 0px;cursor: pointer;" tab="innerlink" target="_blank" textvalue="深度学习" wah-hotarea="click"><span style='outline: 0px;color: rgb(0, 82, 255);cursor: pointer;-webkit-user-drag: none;letter-spacing: 0px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;font-size: 13px;'><strong style="outline: 0px;">深度学习</strong></span></a><span style='outline: 0px;font-size: 13px;letter-spacing: 0px;color: black;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;'>领域的原创文章，一起研习，共同进步！</span></h5><section style='margin-top: 10px;text-wrap: wrap;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;font-size: 16px;outline: 0px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;'><span style='outline: 0px;font-family: Helvetica, "Myriad Pro";font-size: 13px;color: rgb(136, 136, 136);'>长按👇关注- 机器学习研习院 - 设为星标，干货速递</span><img class="rich_pages wxw-img __bg_gif" data-galleryid="" data-imgfileid="100020473" data-ratio="0.4365152919369787" data-src="https://mmbiz.qpic.cn/mmbiz_gif/eWEPx9ZqUHs5fJbERjGmIEtGBtIrtN8UUNrIzG2ctibdchWsdolr3xniblhakVY936icabEzGKgAwZp8e2JG0EGZg/640?wx_fmt=gif" data-type="gif" data-w="1079" src="20240525_032012_8.jpeg" style="letter-spacing: 0.544px;outline: 0px;width: 677px !important;visibility: visible !important;height: auto !important;"/></section><p style='margin-bottom: 0em;text-wrap: wrap;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, "PingFang SC", Cambria, Cochin, Georgia, Times, "Times New Roman", serif;font-size: 16px;outline: 0px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;'></p><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></div>

</div>
                <p></p>
                <p></p>
                <div>本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 </div>
                <div  class="hidden">本文由“公众号文章抓取器”生成，请忽略上文所有联系方式或指引式信息。有问题可以联系：五人工作室，官网：www.Wuren.Work，QQ微信同号1976.424.585 <br><p class="hidden">code/s?__biz=MzkxODI5NjE1OQ==&mid=2247504145&idx=1&sn=89f9b9761c9dc2d2ce17fec28506372b&chksm=c1b11221f6c69b37d1b99ec74771d25ef53ff94f609e297bbdce68be0d67cc1c7cac8d4c7669#rd </p></div>
            </body>
            </html>
            